<h1>Quals Saudi and Oman National Cyber Security CTF 2019 â€“ Back to basics</h1>

<ul>
<li><strong>Category:</strong> Web Security</li>
<li><strong>Points:</strong> 50</li>
</ul>

<h2>Challenge</h2>

<blockquote>
  <p>not pretty much many options. No need to open a link from a browser, there is always a different way</p>
  
  <p><a href="http://35.197.254.240/backtobasics">http://35.197.254.240/backtobasics</a></p>
</blockquote>

<h2>Solution</h2>

<p>Opening the URL with browser will redirect to Google.</p>

<p><em>curl</em> should be used to GET the page.</p>

<p>```
$ curl -X GET -i http://35.197.254.240/backtobasics/
HTTP/1.1 200 OK
Server: nginx/1.10.3 (Ubuntu)
Date: Thu, 07 Feb 2019 20:44:45 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Allow: GET, POST, HEAD,OPTIONS</p>

<script> document.location = "http://www.google.com"; </script>

<p>```</p>

<p>The URL seems to allow following HTTP operations: <code>GET</code>, <code>POST</code>, <code>HEAD</code>, <code>OPTIONS</code>.</p>

<p>Using <code>POST</code> will return the following.</p>

<p>```
$ curl -X POST -i http://35.197.254.240/backtobasics/
HTTP/1.1 200 OK
Server: nginx/1.10.3 (Ubuntu)
Date: Thu, 07 Feb 2019 20:42:56 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Allow: GET, POST, HEAD,OPTIONS</p>

<p><!--
var <em>0x7f88=["","join","reverse","split","log","ceab068d9522dc567177de8009f323b2"];function reverse(</em>0xa6e5x2){flag= <em>0xa6e5x2<a href="_0x7f88[0]"></em>0x7f88[3]</a><a href=""><em>0x7f88[2]</a><a href="_0x7f88[0]"></em>0x7f88[1]</a>}console[<em>0x7f88[4]]= reverse;console<a href="_0x7f88[5]"></em>0x7f88[4]</a>
-->
```</p>

<p>The returned JavaScript can be written like the following to retrieve the flag.</p>

<p>```javascript
var _0x7f88=["","join","reverse","split","log","ceab068d9522dc567177de8009f323b2"];</p>

<p>function reverse(<em>0xa6e5x2) {
  flag= _0xa6e5x2<a href="_0x7f88[0]"></em>0x7f88[3]</a><a href=""><em>0x7f88[2]</a><a href="_0x7f88[0]"></em>0x7f88[1]</a>
  console.log(flag)
}</p>

<p>//console[<em>0x7f88[4]]= reverse;
//console<a href="_0x7f88[5]"></em>0x7f88[4]</a>;
reverse(_0x7f88[5]);
```</p>

<p>The flag is the following.</p>

<p><code>
2b323f9008ed771765cd2259d860baec
</code></p>
