Description: "BookShelf Pico, my premium online book-reading service.
I believe that my website is super secure. I challenge you to prove me wrong by reading the 'Flag' book!"

After start of the instance picoCTF will provide you source code of the site and link to running instance.

The site has a login screen and a main screen with books. We can't access any of them except the first one. Let's dive into the code.

There are some files, that are interesting to us. Inside `JwtService.java` we can see all data, that JwtToken contain, the issuer and that `secretGenerator` gives the secret key.
In `SecretGenerator.Java`, we found out that "secret key" is `1234`. We have all the information to encode and decode JWT tokens.

We need a userId, so let's go back to the login screen. Using Google Chrome, press F12, open `Network` tab and login with creds from picoCTF: user:`user`, pass:`user`.
We can get the JWT token for our user in the payload of the response. Copy it and go to `jwt.io` to decode it, revealing the `userId` as `1`.

Now let's encode our JWT token with role `Admin`. In the `controllers` directory, we can find `UserController.java`, which has an endpoint for updating user roles. We will use Postman to send some requests with the new JWT to update our role and read the flag.

First, we need to create a new user on the site because we can't patch the default user role. Next, we need to obtain the users list. Put the token into headers and send a request. Our id is `6`. Now let's patch our role.

Now that we are an `Admin`, just log in and read the flag.
