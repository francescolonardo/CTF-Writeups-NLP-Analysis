import os
import json

# specify the directory you want to search
rootdir = "../dataset_writeups"

# loop through all subdirectories
for foldername, subfolders, filenames in os.walk(rootdir):
    for filename in filenames:
        if filename.endswith("_taxl1.json"):
            filepath = os.path.join(foldername, filename)
            with open(filepath, "r") as f:
                data = json.load(f)

            for step in data["AttackModel"]["Steps"]:
                for substep in step["Substeps"]:
                    if substep["SubstepType"] == "A":
                        substep["SubstepType"] = "Analysis"
                    elif substep["SubstepType"] == "B":
                        substep["SubstepType"] = "Exploitation"

            with open(filepath, "w", encoding="utf-8") as f:
                json.dump(data, f, indent=4)

print("Replacement completed.")
