<h1>FBI WARNING</h1>

<p>```
Please help FBI to arrest Ωrange!
(Flag format: hitcon{<ip-address-of-Ωrange>})
(Hint: The prefix of the IP address is 219)</p>

<p>http://3.112.91.135/</p>

<p>```</p>

<p>The link goes to an image board with only 1 post (only static HTML left) and it shows this message</p>

<p>```
FBI was hacked Name Ωrange 21/12/03(金)22:14 ID:ueyUrcwA No.2   [返信]</p>

<pre><code>I have hacked FBI and dump the DB here.
https://tinyurl.com/fbi-hack
</code></pre>

<p>```</p>

<p>The goal is to figure out the IP address of the poster, and this is possible to figure out through the tripcode ("ueyUrcwA").</p>

<p>We find some code snippets of <a href="https://github.com/futoase/futaba-ng/blob/49eec202a9fbd73273c492c8e685d62b8ec47969/app/dest/futaba.php">futaba-ng</a> online, which shows how the tripcode is generated. It is essentially</p>

<p><code>php
ID:".substr(crypt(md5($_SERVER["REMOTE_ADDR"].IDSEED.gmdate("Ymd", $time+9*60*60)),'id'),-8)
</code></p>

<p>where IDSEED is some salt, where the default is </p>

<p><code>php
define("IDSEED", 'idの種');
</code></p>

<p>Since we know the time it was posted, it is easy to brute force the unknown octets of the IP address.</p>

<p>```php
<?php</p>

<p>define("IDSEED", 'idの種');</p>

<p>$time = 16385372593;
$target = "ueyUrcwA";</p>

<p>foreach(range(0, 256) as $a)
{
    foreach(range(0, 256) as $b)
    {
        foreach(range(0, 256) as $c)
        {
            $addr = "219" . "." . $a . "." . $b . "." . $c;
            //$g = substr(crypt(md5($addr.IDSEED.gmdate("Ymd", $time+9<em>60</em>60)),'id'),-8);
            $g = substr(crypt(md5($addr.IDSEED."20211203"),'id'),-8);
            if ($g === $target)
            {
                echo $addr . "\n";
            }
        }
    }
}
?>
```</p>

<p>After a short amount of time, the correct IP pops out</p>

<p><code>hitcon{219.91.64.47</code></p>
