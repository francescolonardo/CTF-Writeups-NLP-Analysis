{
    "AttackModel": {
        "NameOfTheChallenge": "SecureBank XSS Search",
        "AttackerCapabilities": [
            "Knowledge of XSS vulnerabilities",
            "Understanding of Same Origin Policy (SOP)",
            "Ability to manipulate window.location"
        ],
        "Target": {
            "Type": "Web Application",
            "Vulnerabilities": [
                "XSS vulnerability in the /checkbalance endpoint",
                "Class of vulnerabilities known as XS Leaks"
            ],
            "SecurityMeasures": [
                "Same Origin Policy (SOP)"
            ]
        },
        "Steps": [
            {
                "StepNumber": 1,
                "Description": "Exploit the XSS vulnerability to perform an XS Search on the user's account balance.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker's goal is to determine the account balance of the admin.",
                    "Action": "Open the /checkbalance endpoint with a query parameter for the desired amount as a new window.",
                    "Result": "Depending on the balance, the window may be redirected to the / endpoint.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 2,
                "Description": "Change the location of the new window back to the exploit server to bypass Same Origin Policy (SOP).",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "To bypass SOP, the attacker needs to change the location of the new window back to the exploit server.",
                    "Action": "Modify the window's location to the exploit server.",
                    "Result": "Both the original and new windows are now of the same origin.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 3,
                "Description": "Check the window's history.length attribute to determine if a redirect occurred.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "By checking the window's history.length attribute, the attacker can determine if a redirect occurred in step 2.",
                    "Action": "Retrieve the window's history.length attribute.",
                    "Result": "The value of history.length will indicate if a redirect occurred.",
                    "Success": "Success",
                    "FailingReason": null
                }
            }
        ]
    }
}