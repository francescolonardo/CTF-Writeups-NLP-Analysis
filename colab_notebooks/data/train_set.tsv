-DOCSTART- -X- O O
This	O
site	O
allows	O
you	O
to	O
write	O
HTML	O
,	O
so	O
it	O
's	O
basically	O
shouting	O
at	O
you	O
to	O
perform	O
an	O
XSS	B-VULNERABILITY/CWE
attack	O
.	O
The	O
URL	B-TARGET COMPONENT
of	O
the	O
webpage	O
created	O
actually	O
consists	O
a	O
base64	O
encoded	O
form	O
of	O
the	O
content	O
of	O
the	O
page	O
.	O
We	O
can	O
see	O
the	O
`	O
js	O
`	O
in	O
the	O
source	O
.	O

The	O
main	O
thing	O
we	O
notice	O
is	O
that	O
it	O
prevents	O
`	O
script	B-TOOL_USED
`	O
tags	O
and	O
it	O
allows	O
only	O
the	O
following	O
attributes	O
for	O
an	O
element	O
:	O
`	O
'	O
src	O
'	O
,	O
'	O
width	O
'	O
,	O
'	O
height	O
'	O
,	O
'	O
alt	O
'	O
,	O
'	O
class	O
'	O
`	O
.	O
So	O
we	O
have	O
to	O
perform	O
an	O
XSS	B-VULNERABILITY/CWE
with	O
these	O
attributes	O
.	O
So	O
,	O
here	O
's	O
the	O
payload	B-TOOL_USED
:	O

[	O
Payload	B-TOOL_USED
for	O
XSS	B-VULNERABILITY/CWE
attack	O
using	O
an	O
iframe	O
and	O
the	O
'	O
src	O
'	O
attribute	O
]	O

Note	O
that	O
here	O
,	O
the	O
site	O
is	O
supposed	O
to	O
be	O
`	O
https	B-MITIGATION STRATEGY
`	O
,	O
otherwise	O
there	O
will	O
be	O
a	O
Content	B-MITIGATION STRATEGY
Security	I-MITIGATION STRATEGY
Policy	I-MITIGATION STRATEGY
Bypass	O
(	O
CSP	B-MITIGATION STRATEGY
Bypass	O
)	O
error	O
,	O
and	O
the	O
request	O
wo	O
n't	O
be	O
sent	O
.	O
We	O
can	O
get	O
the	O
URL	B-TARGET COMPONENT
of	O
the	O
resulting	O
webpage	O
:	O

[	O
URL	B-TARGET COMPONENT
with	O
base64	O
encoded	O
payload	B-TOOL_USED
]	O

On	O
the	O
server	O
,	O
we	O
can	O
create	O
a	O
simple	O
Node.js	O
backend	O
which	O
accepts	O
the	O
cookie	B-TARGET COMPONENT
as	O
a	O
query	O
param	O
and	O
logs	O
it	O
.	O
Here	O
's	O
an	O
example	O
of	O
the	O
backend	O
code	O
:	O

[	O
Node.js	O
code	O
for	O
a	O
simple	O
backend	O
to	O
log	O
the	O
stolen	O
cookie	B-TARGET COMPONENT
]	O

When	O
the	O
link	O
for	O
the	O
website	O
is	O
sent	O
to	O
the	O
`	O
admin	O
bot	O
`	O
,	O
which	O
is	O
basically	O
a	O
headless	O
chrome	O
browser	O
,	O
it	O
visits	O
the	O
page	O
and	O
it	O
's	O
cookie	B-TARGET COMPONENT
is	O
stolen	O
and	O
sent	O
to	O
the	O
server	O
at	O
`	O
myserver.tld	O
`	O
.	O
The	O
cookie	B-TARGET COMPONENT
stores	O
the	O
`	O
flag	O
`	O
.	O


-DOCSTART- -X- O O
This	O
challenge	O
uses	O
XSS	B-VULNERABILITY/CWE
to	O
get	O
the	O
flag	O
from	O
the	O
`	O
admin	O
bot	O
's	O
`	O
cookies	O
.	O

First	O
,	O
try	O
a	O
random	O
`	O
<	O
h1	O
>	O
Hello</h1	O
>	O
`	O
tag	O
to	O
see	O
if	O
you	O
can	O
put	O
HTML	O
in	O
your	O
pastebin	O
.	O

Inspecting	O
the	O
`	O
js	O
`	O
file	O
of	O
the	O
page	O
we	O
can	O
can	O
infer	O
2	O
things	O
:	O

-	O
the	O
content	O
of	O
the	O
page	O
is	O
obtained	O
from	O
the	O
URL	B-TARGET COMPONENT
,	O
which	O
is	O
a	O
base64	O
encoded	O
form	O
of	O
the	O
text	O
you	O
entered	O
.	O

-	O
the	O
`	O
clean	O
`	O
function	O
will	O
not	O
allow	O
writing	O
of	O
text	O
if	O
bracket	O
pairs	O
do	O
not	O
match	O
.	O

It	O
is	O
rather	O
easy	O
to	O
break	O
this	O
`	O
clean	O
`	O
function	O
,	O
by	O
adding	O
an	O
extra	O
`	O
>	O
`	O
at	O
the	O
starting	O
of	O
your	O
XSS	B-VULNERABILITY/CWE
script	B-TOOL_USED
.	O
Here	O
's	O
the	O
payload	B-TOOL_USED
:	O

[	O
Payload	B-TOOL_USED
for	O
XSS	B-VULNERABILITY/CWE
attack	O
with	O
an	O
extra	O
"	O
>	O
"	O
at	O
the	O
beginning	O
of	O
the	O
script	B-TOOL_USED
]	O

Your	O
payload	B-TOOL_USED
has	O
the	O
following	O
URL	B-TARGET COMPONENT
:	O

[	O
URL	B-TARGET COMPONENT
with	O
base64	O
encoded	O
payload	B-TOOL_USED
]	O

You	O
can	O
simply	O
set	O
up	O
a	O
`	O
netcat	B-TOOL_USED
listener	O
`	O
using	O
`	O
nc	O
-l	O
port	B-TARGET COMPONENT
`	O
on	O
your	O
server	O
,	O
and	O
pass	O
the	O
link	O
to	O
the	O
`	O
Admin	O
Bot	O
`	O
.	O
The	O
admin	O
bot	O
is	O
basically	O
a	O
headless	O
chrome	O
browser	O
which	O
has	O
the	O
flag	O
in	O
it	O
's	O
cookies	O
.	O
When	O
it	O
visits	O
your	O
site	O
,	O
the	O
XSS	B-VULNERABILITY/CWE
steals	O
the	O
cookies	O
from	O
the	O
admin	O
bot	O
and	O
sends	O
it	O
to	O
your	O
server	O
.	O
You	O
get	O
a	O
request	O
which	O
looks	O
like	O
:	O

[	O
HTTP	O
GET	O
request	O
with	O
the	O
flag	O
in	O
the	O
cookie	B-TARGET COMPONENT
]	O

