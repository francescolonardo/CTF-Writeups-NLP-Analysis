The goal was to bypass a WAF again, but this time the IP adress was checked using [ipaddress](https://docs.python.org/3/library/ipaddress.html) library. 

Because the above code does two DNS resolves, first to check if private and second to request the resource, I simply added two A records to the DNS entry. 

After a few attempts I got a flag: