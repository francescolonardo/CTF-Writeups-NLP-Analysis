{
    "AttackModel": {
        "NameOfTheChallenge": "Don't Touch My Flag",
        "AttackerCapabilities": [
            "Knowledge of web application vulnerabilities",
            "Ability to manipulate HTTP requests",
            "Understanding of URL parsing and manipulation"
        ],
        "Target": {
            "Type": "Web Application",
            "Vulnerabilities": [
                "Improper URL parsing and joining in the proxy server",
                "Insecure handling of secret cookie in the backend server"
            ],
            "SecurityMeasures": [
                "No input validation on the 'uri' parameter in the proxy server",
                "Insecure storage and comparison of secret cookie in the backend server"
            ]
        },
        "Steps": [
            {
                "StepNumber": 1,
                "Description": "Exploit the improper URL parsing and joining in the proxy server to make a request to the attacker's server.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker's goal is to trick the proxy server into making a request to their own server by manipulating the 'uri' parameter.",
                    "Action": "The attacker sends a GET request to the proxy server with a user-controlled 'uri' parameter set to '//ATTACKER-URL'.",
                    "Result": "The proxy server makes a request to the attacker's server, including the secret cookie in the request headers.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 2,
                "Description": "Capture the secret cookie from the request made by the proxy server to the attacker's server.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker's goal is to obtain the secret cookie sent by the proxy server to their server.",
                    "Action": "The attacker inspects the request received by their server and extracts the value of the 'secret' cookie.",
                    "Result": "The attacker successfully obtains the secret cookie.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 3,
                "Description": "Exploit the insecure handling of the secret cookie in the backend server to obtain the flag.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker's goal is to send a request directly to the backend server with the obtained secret cookie to retrieve the flag.",
                    "Action": "The attacker sends a request to the backend server with the obtained secret cookie.",
                    "Result": "The backend server verifies the secret cookie, returns the flag.",
                    "Success": "Success",
                    "FailingReason": null
                }
            }
        ]
    }
}