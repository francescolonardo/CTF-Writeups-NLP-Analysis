Identify the Server-Side Template Injection vulnerability in the URL.

Test various URL expressions, noting that certain characters and words return strange messages or 404 errors.

Determine that the template engine is likely Jinja2 with some restrictions.

Craft a payload to retrieve all subclasses and analyze the list of returned subclasses.

Create another payload to execute the `id` command and observe the output.

Use remote command execution to list the directory content and obtain the flag.
