-DOCSTART- -X- O O
The	O
challenge	O
is	O
very	O
simple	O
once	O
you	O
know	O
what	O
to	O
do	O
.	O

This	O
is	O
the	O
hint	O
:	O

"	O
We	O
will	O
only	O
give	O
our	O
flag	O
to	O
our	O
Agent	O
95	O
!	O
He	O
is	O
still	O
running	O
an	O
old	O
version	O
of	O
Windows	O
...	O
"	O

We	O
assume	O
Agent	O
95	O
uses	O
Windows	O
95	O
.	O
So	O
just	O
change	O
the	O
`	O
User	O
-	O
Agent	O
`	O
header	O
to	O
`	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
4.01	O
;	O
Windows	O
95	O
)	O
`	O
.	O

We	O
use	O
a	O
Python	B-TOOL_USED
script	I-TOOL_USED
:	O

[	O
Python	O
code	O
:	O
using	O
`	O
requests	B-TOOL_USED
`	O
to	O
send	O
a	O
GET	O
with	O
the	O
`	O
User	O
-	O
Agent	O
`	O
header	O
]	O

In	O
the	O
response	O
,	O
you	O
got	O
the	O
flag	O
.	O


-DOCSTART- -X- O O
When	O
you	O
visit	O
the	O
website	O
,	O
you	O
find	O
that	O
there	O
's	O
a	O
cookie	B-TARGET COMPONENT
containing	O
a	O
JWT	O
.	O
It	O
's	O
hashed	O
using	O
`	O
HS256	O
`	O
.	O
The	O
JWT	O
secret	O
was	O
brute	O
-	O
forced	O
using	O
`	O
rockyou.txt	O
`	O
and	O
John	B-TOOL_USED
The	I-TOOL_USED
Ripper	I-TOOL_USED
,	O
which	O
revealed	O
the	O
secret	O
as	O
`	O
supersecret	O
`	O
.	O
Using	O
this	O
secret	O
,	O
a	O
JWT	O
with	O
`	O
username	O
:	O
admin	O
`	O
was	O
created	O
and	O
added	O
to	O
the	O
cookie	B-TARGET COMPONENT
,	O
logging	O
in	O
as	O
admin	O
.	O

Visiting	O
a	O
random	O
route	O
starting	O
with	O
`	O
/admin/	O
`	O
that	O
throws	O
a	O
404	O
error	O
,	O
it	O
was	O
observed	O
that	O
there	O
's	O
scope	O
for	O
template	B-VULNERABILITY/CWE
injection	I-VULNERABILITY/CWE
in	O
the	O
404	O
page	O
.	O
By	O
climbing	O
up	O
the	O
Python	O
MRO	O
using	O
`	O
_	O
_	O
class	O
_	O
_	O
`	O
and	O
`	O
_	O
_	O
bases	O
_	O
_	O
`	O
,	O
etc	O
.	O
,	O
a	O
list	O
of	O
all	O
available	O
classes	O
was	O
found	O
.	O
At	O
index	O
405	O
,	O
the	O
`	O
subprocess	O
.	O
Popen	O
`	O
class	O
was	O
discovered	O
.	O

Using	O
this	O
class	O
,	O
a	O
reverse	O
shell	O
was	O
spawned	O
by	O
sending	O
a	O
specially	O
crafted	O
URL	B-TARGET COMPONENT
.	O
A	O
netcat	B-TOOL_USED
listener	O
was	O
started	O
on	O
the	O
server	O
at	O
the	O
specified	O
port	B-TARGET COMPONENT
,	O
which	O
ultimately	O
led	O
to	O
gaining	O
a	O
shell	O
.	O

Upon	O
listing	O
the	O
files	O
and	O
reading	O
the	O
content	O
of	O
`	O
flag.txt	O
`	O
.	O

