<h1>SOAP</h1>

<h2>Overview</h2>

<p>100 points</p>

<p>Category: <a href="../">Web Exploitation</a></p>

<p>Tags : <code>#picoCTF 2023</code> <code>Web Exploitation</code> <code>XXE</code></p>

<h2>Description</h2>

<p>The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?</p>

<p>Additional details will be available after launching your challenge instance.</p>

<h2>Solution</h2>

<p>After start of the instance picoCTF will provide you a link to running instance.</p>

<p>There is a site.</p>

<p><img src="1.jpg" alt="Screenshot of the main screen" /></p>

<p>We saw tag <code>XXE</code> -> <code>XML external entity</code> and also, when we inspect static resources (F12 -> Sources in Google Chrome) of the site, we saw this two files:</p>

<p>detailsCheck.js</p>

<p><img src="2.jpg" alt="Screenshot of the js" /></p>

<p>xmlDetailsCheckPayload.js</p>

<p><img src="3.jpg" alt="Screenshot of the js" /></p>

<p>So, now we know for sure, that it is XXE. </p>

<p>Also in the index.html we saw the endpoint for the POST request:</p>

<p><img src="4.jpg" alt="Screenshot of the index.html" /></p>

<p>We need just to make POST request to the <code>&lt;url_of_site&gt;/data</code> with XML payload to get the flag.</p>

<p>Let's check the format for XML request. Just click button on the site and look the request format in <code>Network</code> tab:</p>

<p><img src="5.jpg" alt="Screenshot of the debug tab" /></p>

<p>Now just send <code>POST</code> request with our payload and obtain the flag:</p>

<p><img src="6.jpg" alt="Screenshot of the flag" /></p>
