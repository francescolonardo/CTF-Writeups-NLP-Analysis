{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "The challenge involved an application where the markdown input gets converted into a PDF file available for download",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Examined the application."
                    },
                    {
                        "SubstepNumber": 1.2,
                        "SubstepString": "Noted the process of converting markdown input to PDF file for download."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "The first step was examining the 'package.json' file found in the site source",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Examined the 'package.json' file in the site source."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "In this file two dependencies 'md-to-pdf' and 'nunjucks' were identified as potentially interesting",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Identified the dependencies 'md-to-pdf' and 'nunjucks' in the 'package.json' file."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Research led to the discovery of a CVE for 'md-to-pdf' and a payload that could potentially exploit this vulnerability",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Conducted research on 'md-to-pdf'."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Discovered a CVE for 'md-to-pdf'."
                    },
                    {
                        "SubstepNumber": 4.3,
                        "SubstepString": "Identified a payload that could potentially exploit the vulnerability in 'md-to-pdf'."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "The original payload did not work, leading to further research and discovery of a known issue in 'nunjucks' that it was having issues with single line payload",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Revisited the original payload."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Conducted further research on 'nunjucks'."
                    },
                    {
                        "SubstepNumber": 5.3,
                        "SubstepString": "Discovered a known issue in 'nunjucks' related to single line payload."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "It was discovered that the payload needed to be adjusted to work with 'nunjucks', this was done by making sure line 1 and 3 of the payload were written in a specific way",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Identified the need to adjust the payload for 'nunjucks'."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Adjusted line 1 and 3 of the payload to work with 'nunjucks'."
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "The payload used was one that executed a command to find the flag and redirected it to a file in the invoices directory",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Generated a payload for executing a command."
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Executed the payload to find the flag."
                    },
                    {
                        "SubstepNumber": 7.3,
                        "SubstepString": "Redirected the flag to a file in the invoices directory."
                    }
                ]
            },
            {
                "StepNumber": 8,
                "StepString": "With this payload, the flag was successfully captured",
                "Substeps": [
                    {
                        "SubstepNumber": 8.1,
                        "SubstepString": "Captured the flag with the payload."
                    }
                ]
            }
        ]
    }
}