{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Visited the website that allows file uploads",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Visit the website"
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Read HTML and found a comment containing PHP code to upload a file. This code also renames an uploaded file with a random name while preserving the file extension",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Read HTML"
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Find a comment containing PHP code to upload a file"
                    },
                    {
                        "SubstepNumber": 2.3,
                        "SubstepString": "Note that the PHP code renames the uploaded file with a random name while preserving the file extension"
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Uploaded a PHP shell which can be executed by visiting the uploaded file",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Upload a PHP shell"
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Note that the PHP shell can be executed by visiting the uploaded file"
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Ran the PHP shell, but it was unsuccessful",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Run the PHP shell"
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Note that the execution of the PHP shell was unsuccessful"
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Added phpinfo() to the code in the PHP shell to get information about the PHP configuration",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Add phpinfo() to the code in the PHP shell"
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Get information about the PHP configuration"
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Noticed that the PHP configuration has several functions disabled, but 'scandir' and 'file_get_contents' are not disabled",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Notice that the PHP configuration has several functions disabled"
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Note that 'scandir' and 'file_get_contents' are not disabled"
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "Wrote a new PHP exploit using 'scandir' and 'file_get_contents' to browse through files in the '/etc' directory and find the flag which is meant to be in a file in that directory",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Write a new PHP exploit"
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Use 'scandir' and 'file_get_contents' to browse through files in the '/etc' directory"
                    },
                    {
                        "SubstepNumber": 7.3,
                        "SubstepString": "Find the flag, which is meant to be in a file in the '/etc' directory"
                    }
                ]
            },
            {
                "StepNumber": 8,
                "StepString": "Created and uploaded the new PHP exploit",
                "Substeps": [
                    {
                        "SubstepNumber": 8.1,
                        "SubstepString": "Create the new PHP exploit"
                    },
                    {
                        "SubstepNumber": 8.2,
                        "SubstepString": "Upload the new PHP exploit"
                    }
                ]
            },
            {
                "StepNumber": 9,
                "StepString": "Ran the PHP exploit and got the flag reading from a file in the '/etc' directory",
                "Substeps": [
                    {
                        "SubstepNumber": 9.1,
                        "SubstepString": "Run the PHP exploit"
                    },
                    {
                        "SubstepNumber": 9.2,
                        "SubstepString": "Get the flag by reading from a file in the '/etc' directory"
                    }
                ]
            },
            {
                "StepNumber": 10,
                "StepString": "Flag was 'darkCON{us1ng_3_y34r_01d_bug_t0_byp4ss_d1s4ble_funct10n}'",
                "Substeps": [
                    {
                        "SubstepNumber": 10.1,
                        "SubstepString": "Note that the flag obtained was 'darkCON{us1ng_3_y34r_01d_bug_t0_byp4ss_d1s4ble_funct10n}'"
                    }
                ]
            }
        ]
    }
}