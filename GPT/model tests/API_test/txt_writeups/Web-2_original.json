{
    "AttackModel": {
        "NameOfTheChallenge": "Web-2",
        "AttackerCapabilities": [
            "Knowledge of JWT authentication",
            "Ability to read and understand code",
            "Ability to use JWT libraries in code"
        ],
        "Target": {
            "Type": "Web Application",
            "Vulnerabilities": [
                "Improper storage of private key",
                "Insecure JWT algorithm"
            ],
            "SecurityMeasures": [
                "JWT authentication",
                "Token verification"
            ]
        },
        "Steps": [
            {
                "StepNumber": 1,
                "Description": "The attacker opens the link and sees a login form. They attempt to login with any random username and password.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker assumes that the login form is vulnerable to some kind of authentication bypass or token manipulation.",
                    "Action": "The attacker tries logging in with random credentials.",
                    "Result": "The attacker gets redirected to /flag page with a message 'Not admin, no flag for you hmmm...'",
                    "Success": "Failed",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 2,
                "Description": "The attacker checks the cookies and finds a token with a value.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker assumes that the token may be used for authentication or authorization.",
                    "Action": "The attacker inspects the cookies and finds a token.",
                    "Result": "The attacker finds a token with a value.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 3,
                "Description": "The attacker checks the token on jwt.io and discovers that it is using the RS256 algorithm.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker assumes that the RS256 algorithm requires a private key to generate and verify tokens.",
                    "Action": "The attacker inspects the token on jwt.io and finds that it uses the RS256 algorithm.",
                    "Result": "The attacker confirms that the RS256 algorithm requires a private key.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 4,
                "Description": "The attacker accesses the /robots.txt file and finds the private key.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker assumes that the private key may be used to generate a valid token and bypass authentication.",
                    "Action": "The attacker visits the /robots.txt file and finds the private key.",
                    "Result": "The attacker obtains the private key.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 5,
                "Description": "The attacker uses the private key to generate a token with admin privileges.",
                "ToolsUsed": "nodejs jsonwebtoken library",
                "StepDetails": {
                    "Hypothesis": "The attacker assumes that by generating a token with admin privileges using the private key, they can access the /flag page.",
                    "Action": "The attacker uses the private key and the jsonwebtoken library to generate a token with the 'admin' user.",
                    "Result": "The attacker successfully generates a token with admin privileges.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 6,
                "Description": "The attacker accesses the /flag page using the generated token as a cookie.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker assumes that by accessing the /flag page with the generated token, they will be able to view the flag.",
                    "Action": "The attacker visits the /flag page and sets the generated token as a cookie.",
                    "Result": "The attacker successfully accesses the /flag page and obtains the flag.",
                    "Success": "Success",
                    "FailingReason": null
                }
            }
        ]
    }
}