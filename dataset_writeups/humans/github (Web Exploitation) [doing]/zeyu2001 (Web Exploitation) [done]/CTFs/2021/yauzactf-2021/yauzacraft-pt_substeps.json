{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Identified a user profile with list of created books hosted on the server",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Identify a user profile."
                    },
                    {
                        "SubstepNumber": 1.2,
                        "SubstepString": "Discover list of created books hosted on the server."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Understood each book's URL structure on server as /books/USER_ID/FILENAME",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Understand each book's URL structure on server."
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Identify USER_ID."
                    },
                    {
                        "SubstepNumber": 2.3,
                        "SubstepString": "Identify FILENAME."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Discovered the server was powered by PHP",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Discover the server technology."
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Identify PHP as the server technology."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Noticed that files with commonly used extensions are downloaded, while .html files are rendered inline",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Observe the behavior of file downloads."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Notice that files with commonly used extensions are downloaded."
                    },
                    {
                        "SubstepNumber": 4.3,
                        "SubstepString": "Notice that .html files are rendered inline."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Attempted to upload a .php file to run arbitrary PHP code",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Attempt to upload a file."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Choose a .php file for upload."
                    },
                    {
                        "SubstepNumber": 5.3,
                        "SubstepString": "Intend to run arbitrary PHP code."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Realized that .php extensions were being recursively filtered",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Realize the filtering of .php extensions."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Notice the recursive nature of the filtering."
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "Tested different file extensions and found .phtml extension, which also executes PHP code, was not being filtered",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Test different file extensions."
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Discover the .phtml extension."
                    },
                    {
                        "SubstepNumber": 7.3,
                        "SubstepString": "Verify that .phtml extension executes PHP code."
                    },
                    {
                        "SubstepNumber": 7.4,
                        "SubstepString": "Determine that the .phtml extension is not being filtered."
                    }
                ]
            },
            {
                "StepNumber": 8,
                "StepString": "Uploaded a PHP webshell with a .phtml extension",
                "Substeps": [
                    {
                        "SubstepNumber": 8.1,
                        "SubstepString": "Upload a PHP webshell."
                    },
                    {
                        "SubstepNumber": 8.2,
                        "SubstepString": "Choose a .phtml file for upload."
                    }
                ]
            },
            {
                "StepNumber": 9,
                "StepString": "Navigated to the uploaded webshell and ran the command cat /flag.txt",
                "Substeps": [
                    {
                        "SubstepNumber": 9.1,
                        "SubstepString": "Navigate to the uploaded webshell."
                    },
                    {
                        "SubstepNumber": 9.2,
                        "SubstepString": "Execute the command cat /flag.txt."
                    }
                ]
            },
            {
                "StepNumber": 10,
                "StepString": "Acquired the flag YauzaCTF{PHP_minecraft_h4ck3r} by executing the command",
                "Substeps": [
                    {
                        "SubstepNumber": 10.1,
                        "SubstepString": "Acquire the flag."
                    }
                ]
            }
        ]
    }
}