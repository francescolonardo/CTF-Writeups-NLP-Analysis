{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Web server is vulnerable to CVE-2022-26377, enabling Request Smuggling to send AJP Requests",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Identify the vulnerability (CVE-2022-26377)."
                    },
                    {
                        "SubstepNumber": 1.2,
                        "SubstepString": "Exploit the vulnerability to enable Request Smuggling."
                    },
                    {
                        "SubstepNumber": 1.3,
                        "SubstepString": "Craft AJP Requests to be sent using Request Smuggling."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Crafting an AJP request based on a writeup to leak the source code (index.jsp)",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Refer to a writeup for information on crafting the AJP request."
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Craft the AJP request to leak the source code of index.jsp."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Index.jsp reveals that a specific IP address (119.29.29.29) response triggers display of the system environment flag",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Inspect the response from index.jsp."
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Observe that the system environment flag is displayed when the response contains the specific IP address (119.29.29.29)."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Crafting another request setting the remote_addr to the required fake address",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Determine the required fake address."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Craft another request and set the remote_addr to the required fake address."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Sending the crafted request to the server to return the system flag",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Submit the crafted request to the server."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Capture the response from the server."
                    },
                    {
                        "SubstepNumber": 5.3,
                        "SubstepString": "Extract the system flag from the response."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Using an exploit script to generate the payload",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Obtain an exploit script for generating the payload."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Configure the exploit script with the necessary parameters."
                    },
                    {
                        "SubstepNumber": 6.3,
                        "SubstepString": "Execute the exploit script to generate the payload."
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "Sending the payload to the server using curl command",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Obtain the payload generated by the exploit script."
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Construct a curl command to send the payload to the server."
                    },
                    {
                        "SubstepNumber": 7.3,
                        "SubstepString": "Execute the curl command to send the payload to the server."
                    }
                ]
            }
        ]
    }
}