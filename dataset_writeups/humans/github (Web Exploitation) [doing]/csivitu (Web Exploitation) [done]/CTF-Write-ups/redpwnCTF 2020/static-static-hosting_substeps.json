{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Create an XSS payload using an iframe and the 'src' attribute.",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Craft an iframe tag, utilizing the 'src' attribute to point to a malicious destination."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Encode the payload in base64 and create a URL with the encoded payload.",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Encode the XSS payload to base64 format using an appropriate tool or function."
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Create a URL, incorporating the base64 encoded payload in the proper parameter or location."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Ensure the site uses 'https' to avoid Content Security Policy Bypass (CSP Bypass) errors.",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Inspect the site to verify it is utilizing 'https' protocol to ensure secure communication."
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Check for any Content Security Policy headers that might block content loaded over HTTP."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Create a Node.js backend to accept the stolen cookie as a query param and log it.",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Set up a Node.js server with the required modules and dependencies."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Implement an endpoint to receive HTTP requests containing the stolen cookie as a query parameter."
                    },
                    {
                        "SubstepNumber": 4.3,
                        "SubstepString": "Configure the server to log the received cookies for later retrieval."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Send the link to the 'admin bot', which visits the page and has its cookie stolen.",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Identify the mechanism through which links can be submitted to the 'admin bot'."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Send the malicious URL created in Step 2 to the 'admin bot'."
                    },
                    {
                        "SubstepNumber": 5.3,
                        "SubstepString": "Monitor the Node.js backend for any incoming connections or data from the 'admin bot'."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Retrieve the flag stored in the stolen cookie on your server.",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Access the logs on your Node.js server where the cookies have been stored."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Extract the flag from the stolen cookie data."
                    }
                ]
            }
        ]
    }
}
