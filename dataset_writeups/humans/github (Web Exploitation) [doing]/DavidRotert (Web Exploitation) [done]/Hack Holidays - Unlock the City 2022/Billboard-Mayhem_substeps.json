{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Upload a file with a `.tpl` extension and random content, triggering a `POST` to `/upload.php` and a `302 Found` redirect to `/index.php`.",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Create a file with a `.tpl` extension and insert random content."
                    },
                    {
                        "SubstepNumber": 1.2,
                        "SubstepString": "Initiate a `POST` request to `/upload.php` to upload the created file."
                    },
                    {
                        "SubstepNumber": 1.3,
                        "SubstepString": "Receive a `302 Found` response and a redirect to `/index.php`."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Observe that the uploaded content is persistent and displayed on the site, and that uploading a new file changes the content.",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Inspect the site to confirm the display of the uploaded content."
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Upload another file with different content and observe the changes on the site."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Upload a valid PHP file and notice that the server modifies the output, converting PHP tags into HTML comments.",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Craft a valid PHP file with PHP tags."
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Upload the created PHP file to the server."
                    },
                    {
                        "SubstepNumber": 3.3,
                        "SubstepString": "Observe the serverâ€™s response and notice the conversion of PHP tags into HTML comments."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Discover a Server Side Template Injection (SSTI) by uploading a payload with an expression in curly braces.",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Craft a payload containing an expression enclosed in curly braces."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Upload the payload to the server and observe the response for evidence of Server Side Template Injection (SSTI)."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Use an HTML payload to display environment variables and expose files, revealing the presence of the `smarty-4.0.1` PHP library and the `templates_c` folder.",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Develop an HTML payload designed to expose environment variables and file information."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Execute the payload and observe the output, identifying the `smarty-4.0.1` PHP library and the `templates_c` folder."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Access and download the template files on the server by calling their file paths.",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Determine the paths for the template files on the server."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Access and download the identified template files by targeting their paths."
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "Use an HTML payload to execute a system command and display the contents of the `index.php` file, accidentally revealing the flag.",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Create an HTML payload capable of executing system commands."
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Use the payload to display the contents of the `index.php` file."
                    },
                    {
                        "SubstepNumber": 7.3,
                        "SubstepString": "Inspect the displayed contents to identify the flag."
                    }
                ]
            },
            {
                "StepNumber": 8,
                "StepString": "(Alternative) Explore the possibility of an accessible environment variable within the template engine.",
                "Substeps": [
                    {
                        "SubstepNumber": 8.1,
                        "SubstepString": "Investigate the template engine's documentation or behavior to identify any accessible environment variables."
                    },
                    {
                        "SubstepNumber": 8.2,
                        "SubstepString": "Attempt to access and interact with identified environment variables to gain further insights or access."
                    }
                ]
            }
        ]
    }
}
