{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Analysed the `main.dart.js`, which is the Flutter app compiled by `dart2js`.",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Analysed the `main.dart.js`."
                    },
                    {
                        "SubstepNumber": 1.2,
                        "SubstepString": "Recognized that `main.dart.js` is the Flutter app compiled by `dart2js`."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Discovered an `AdminPage` and a `/api/flag` endpoint that is fetched using `postRequestWithCookies`.",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Discovered an `AdminPage`."
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Identified a `/api/flag` endpoint."
                    },
                    {
                        "SubstepNumber": 2.3,
                        "SubstepString": "Recognized that the `/api/flag` endpoint is fetched using `postRequestWithCookies`."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Identified a `/api/token` endpoint in `LoginPage` which returns the current authentication token.",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Identified a `/api/token` endpoint."
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Recognized that the `/api/token` endpoint is in `LoginPage`."
                    },
                    {
                        "SubstepNumber": 3.3,
                        "SubstepString": "Noted that the `/api/token` endpoint returns the current authentication token."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Examined features of the application noticing parameters in the WebSocket message that could be modified to allow callback to our server.",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Examined features of the application."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Identified parameters in the WebSocket message."
                    },
                    {
                        "SubstepNumber": 4.3,
                        "SubstepString": "Recognized that the parameters in the WebSocket message could be modified."
                    },
                    {
                        "SubstepNumber": 4.4,
                        "SubstepString": "Realized that modifying the parameters allows callback to our server."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Attempted XSS payloads, realized that rendering unescaped HTML was hopeless due to the app being rendered on a `<canvas>`.",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Attempted XSS payloads."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Realized that rendering unescaped HTML was unsuccessful."
                    },
                    {
                        "SubstepNumber": 5.3,
                        "SubstepString": "Recognized that the app is rendered on a `<canvas>`."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Manipulated the `widget` parameter to cause a traceback.",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Manipulated the `widget` parameter."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Caused a traceback."
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "Used `Access-Control-Allow-Origin: *` header to avoid CORS issues.",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Used `Access-Control-Allow-Origin: *` header."
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Avoided CORS issues."
                    }
                ]
            },
            {
                "StepNumber": 8,
                "StepString": "Identified the remote Flutter widget file signature.",
                "Substeps": [
                    {
                        "SubstepNumber": 8.1,
                        "SubstepString": "Identified the remote Flutter widget file signature."
                    }
                ]
            },
            {
                "StepNumber": 9,
                "StepString": "Decoded the `chatmessage` widget using Remote Flutter Widgets package.",
                "Substeps": [
                    {
                        "SubstepNumber": 9.1,
                        "SubstepString": "Decoded the `chatmessage` widget."
                    },
                    {
                        "SubstepNumber": 9.2,
                        "SubstepString": "Used Remote Flutter Widgets package for decoding."
                    }
                ]
            },
            {
                "StepNumber": 10,
                "StepString": "Tried to manipulate the `clipboard_getData` function found in `main.dart.js`.",
                "Substeps": [
                    {
                        "SubstepNumber": 10.1,
                        "SubstepString": "Tried to manipulate the `clipboard_getData` function."
                    },
                    {
                        "SubstepNumber": 10.2,
                        "SubstepString": "Found the `clipboard_getData` function in `main.dart.js`."
                    }
                ]
            },
            {
                "StepNumber": 11,
                "StepString": "Took a closer look at `poll.dart` which had a Mechanism `ApiMapper` that makes a GET request to the specified `apiGet` URL.",
                "Substeps": [
                    {
                        "SubstepNumber": 11.1,
                        "SubstepString": "Took a closer look at `poll.dart`."
                    },
                    {
                        "SubstepNumber": 11.2,
                        "SubstepString": "Recognized the Mechanism `ApiMapper` in `poll.dart`."
                    },
                    {
                        "SubstepNumber": 11.3,
                        "SubstepString": "Noted that the `ApiMapper` makes a GET request."
                    },
                    {
                        "SubstepNumber": 11.4,
                        "SubstepString": "Identified the specified `apiGet` URL."
                    }
                ]
            },
            {
                "StepNumber": 12,
                "StepString": "Found a mechanism to fetch the poll options and exfiltrate them to `example.com` in the button `onPressed` event handler `api_post`.",
                "Substeps": [
                    {
                        "SubstepNumber": 12.1,
                        "SubstepString": "Found a mechanism to fetch the poll options."
                    },
                    {
                        "SubstepNumber": 12.2,
                        "SubstepString": "Recognized the `onPressed` event handler `api_post`."
                    },
                    {
                        "SubstepNumber": 12.3,
                        "SubstepString": "Noted that the poll options are exfiltrated to `example.com`."
                    }
                ]
            },
            {
                "StepNumber": 13,
                "StepString": "Modify the `ApiMapper` to fetch the admins token on GET request to the specified `apiGet` URL.",
                "Substeps": [
                    {
                        "SubstepNumber": 13.1,
                        "SubstepString": "Modified the `ApiMapper`."
                    },
                    {
                        "SubstepNumber": 13.2,
                        "SubstepString": "Modified the GET request."
                    },
                    {
                        "SubstepNumber": 13.3,
                        "SubstepString": "Identified the specified `apiGet` URL."
                    }
                ]
            },
            {
                "StepNumber": 14,
                "StepString": "Used the `onLoaded` event handler to trigger the `api_post` event for zero-click exfiltration.",
                "Substeps": [
                    {
                        "SubstepNumber": 14.1,
                        "SubstepString": "Used the `onLoaded` event handler."
                    },
                    {
                        "SubstepNumber": 14.2,
                        "SubstepString": "Triggered the `api_post` event."
                    },
                    {
                        "SubstepNumber": 14.3,
                        "SubstepString": "Performed zero-click exfiltration."
                    }
                ]
            },
            {
                "StepNumber": 15,
                "StepString": "Got the admin's token.",
                "Substeps": [
                    {
                        "SubstepNumber": 15.1,
                        "SubstepString": "Obtained the admin's token."
                    }
                ]
            },
            {
                "StepNumber": 16,
                "StepString": "Fetched the flag from the `/api/flag` endpoint.",
                "Substeps": [
                    {
                        "SubstepNumber": 16.1,
                        "SubstepString": "Fetched the flag."
                    },
                    {
                        "SubstepNumber": 16.2,
                        "SubstepString": "Retrieved the flag from the `/api/flag` endpoint."
                    }
                ]
            }
        ]
    }
}