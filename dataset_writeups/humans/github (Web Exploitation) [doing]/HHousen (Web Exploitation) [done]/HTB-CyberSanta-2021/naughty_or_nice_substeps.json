{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Examine the source code, finding that both 'RS256' and 'HS256' algorithms are allowed for decryption.",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Review the website's source code."
                    },
                    {
                        "SubstepNumber": 1.2,
                        "SubstepString": "Identify the algorithms allowed for decryption, specifically 'RS256' and 'HS256'."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Understand the differences between the HS256 and RS256 algorithms.",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Study the HS256 algorithm, focusing on its mechanics and vulnerabilities."
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Study the RS256 algorithm, focusing on its mechanics and vulnerabilities."
                    },
                    {
                        "SubstepNumber": 2.3,
                        "SubstepString": "Compare the identified characteristics of the HS256 and RS256 algorithms."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Create an account on the website, and obtain the JWT token and public key.",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Register a new account on the website."
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Log into the newly created account."
                    },
                    {
                        "SubstepNumber": 3.3,
                        "SubstepString": "Capture the JWT token assigned to the account."
                    },
                    {
                        "SubstepNumber": 3.4,
                        "SubstepString": "Retrieve the public key associated with the account."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Tamper with the token to change the 'username' to 'admin' using the RS256-to-HS256 exploit.",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Decode the JWT token to expose its payload."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Modify the 'username' field in the token's payload to 'admin'."
                    },
                    {
                        "SubstepNumber": 4.3,
                        "SubstepString": "Re-encode the modified payload using the RS256-to-HS256 exploit."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Swap the tampered token with the non-admin token in your browser's developer tools to access the admin dashboard.",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Open the browser's developer tools and locate the stored JWT token."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Replace the stored JWT token with the tampered token."
                    },
                    {
                        "SubstepNumber": 5.3,
                        "SubstepString": "Navigate to the admin dashboard using the altered token to gain unauthorized access."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Examine the source code again to identify a potential 'nunjucks' SSTI vulnerability.",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Review the websiteâ€™s source code a second time."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Search for instances of 'nunjucks' usage in the code."
                    },
                    {
                        "SubstepNumber": 6.3,
                        "SubstepString": "Assess the identified 'nunjucks' usage for potential SSTI vulnerabilities."
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "Utilize a payload that breaks out of the 'nunjucks' templating engine to read the flag file.",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Craft a payload capable of breaking out of the 'nunjucks' templating engine."
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Inject the crafted payload to attempt to read the flag file."
                    }
                ]
            },
            {
                "StepNumber": 8,
                "StepString": "Insert the payload into one of the elf's name fields in the admin dashboard, and navigate to the homepage to reveal the flag.",
                "Substeps": [
                    {
                        "SubstepNumber": 8.1,
                        "SubstepString": "Navigate to the admin dashboard."
                    },
                    {
                        "SubstepNumber": 8.2,
                        "SubstepString": "Locate an elf's name field."
                    },
                    {
                        "SubstepNumber": 8.3,
                        "SubstepString": "Insert the crafted payload into the located name field."
                    },
                    {
                        "SubstepNumber": 8.4,
                        "SubstepString": "Navigate to the homepage to execute the payload and reveal the flag."
                    }
                ]
            }
        ]
    }
}
