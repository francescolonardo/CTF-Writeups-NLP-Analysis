<h1>Challenge Title: Web-4</h1>

<h2>Description</h2>

<p>This time I have made sure that no secrets will be public but I still think its too weak.</p>

<p>Flag format: darkCTF{FLAG}</p>

<p><a href="http://web4.darkarmy.xyz/">Link</a></p>

<h2>Solution</h2>

<p>Seeing the description we know it should be related to jwt secret brute-forcing, anyway, let's start with it</p>

<p>Log in with junk value, check cookies, use <a href="http://jwt.io">jwt.io</a> on token value </p>

<p>On checking cookies we see there is key <code>token</code> with some value, checking it on <a href="">jwt.io</a> get this</p>

<p><img src="https://github.com/karma9874/CTF-Writeups/blob/master/Dark-PreCTF/Images/token4.JPG" alt="alt text" /></p>

<p>The token is using HS256algorithm with means it is using a secret_key for encryption, on accessing <code>/robots.txt</code> we see nothing now xD</p>

<p>So seeing the description we know it should be related to brute-forcing for secret_key as there is nothing else xD</p>

<p>To do that I used  this tool <a href="https://github.com/ticarpi/jwt_tool">jwt_tool</a> with <code>rockyou.txt</code></p>

<p>```
python3 jwt_tool.py eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiZ3Vlc3QifQ.1mGqtRViJqKA-TYFeNCcSkgLinKt9CgBnGxjL9KXtNA</p>

<p>```</p>

<p><img src="https://github.com/karma9874/CTF-Writeups/blob/master/Dark-PreCTF/Images/bf.JPG" alt="alt text" /></p>

<p>Now we have the secret_key which is <code>redraider</code></p>

<p>So now we build a token of HS256 with secret_key as <code>redraider</code> with value of user as admin.</p>

<p><code>
const jwt = require('jsonwebtoken')
var token = jwt.sign({ 'user': 'admin' },'redraider', { algorithm:'HS256',noTimestamp:true}); 
</code>
<img src="https://github.com/karma9874/CTF-Writeups/blob/master/Dark-PreCTF/Images/node4.JPG" alt="alt text" /></p>

<p>Now access the /flag using the token as cookie and we get the flag</p>

<p><img src="https://github.com/karma9874/CTF-Writeups/blob/master/Dark-PreCTF/Images/flag4.JPG" alt="alt text" /></p>

<p>flag -> <code>darkCTF{5ymm37r1c_k3y_cr4ck1n9}</code></p>

<h2>What was the Bug?</h2>

<p>Don't use secret which can be cracked by bruteforcing it</p>
