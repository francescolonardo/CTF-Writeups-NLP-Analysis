Title: Empire3
Primary topic: Web Exploitation
Secondary topic: Flask Secret Key
Tools used: flask-session-cookie-manager
Keywords: cookies, user_id

#context
We are presented the usual company website, we register and login as usual and we try to add a todo {{config}}.

#discovery
We go in the list of todos and we have a lot of information, the most important is the flask secret key which is used to sign the cookies.

#discovery
Now we check if there is any cookie saved by the website and we find that there is one.

#exploitation
Decrypting it with flask-session-cookie-manager we discover that it contains a user_id field, maybe we can change it and login as another user.

#exploitation
We try set user_id to 1 and we encode the cookie again. As we send the cookie we actually login as jarret.booz but no flag here.

#exploitation
Let's try user_id = 2 and we actually find the flag.

#countermeasures
This challenge highlights the importance of properly securing session management and cookie handling in web applications. It also emphasizes the need for secure coding practices to prevent vulnerabilities such as this one.