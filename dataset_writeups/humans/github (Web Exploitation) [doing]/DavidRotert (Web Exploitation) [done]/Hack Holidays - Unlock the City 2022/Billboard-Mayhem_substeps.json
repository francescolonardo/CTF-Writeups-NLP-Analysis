{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Identified the application can upload TPL files",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Identify the application."
                    },
                    {
                        "SubstepNumber": 1.2,
                        "SubstepString": "Confirm the ability to upload TPL files."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Uploaded a file with the .tpl extension and a random content for identification",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Upload a file."
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Set the file extension as .tpl."
                    },
                    {
                        "SubstepNumber": 2.3,
                        "SubstepString": "Generate random content for the file."
                    },
                    {
                        "SubstepNumber": 2.4,
                        "SubstepString": "Submit the file for identification."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Observed that the uploaded file triggers a POST to /upload.php and then redirects with 302 Found to the /index.php, with the file content displayed",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Observe the uploaded file triggering a POST to /upload.php."
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Notice a redirection with 302 Found to /index.php."
                    },
                    {
                        "SubstepNumber": 3.3,
                        "SubstepString": "Confirm that the file content is displayed."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Uploaded a different file to observe the changes in the content",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Upload a different file."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Submit the file for observation."
                    },
                    {
                        "SubstepNumber": 4.3,
                        "SubstepString": "Note the changes in the displayed content."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Tried uploading a valid PHP file",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Attempt to upload a valid PHP file."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Conducted experiments with different content and observed the server's response which suggested Server Side Template Injection",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Conduct experiments with different content."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Observe the server's response."
                    },
                    {
                        "SubstepNumber": 6.3,
                        "SubstepString": "Determine that the server's response suggests Server Side Template Injection."
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "Applied a payload that reveals some useful information about the server environment and file structure",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Apply a payload."
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Observe the information revealed about the server environment."
                    },
                    {
                        "SubstepNumber": 7.3,
                        "SubstepString": "Observe the information revealed about the file structure."
                    }
                ]
            },
            {
                "StepNumber": 8,
                "StepString": "Discovered the smarty-4.0.1 PHP library and the templates_c folder through investigation",
                "Substeps": [
                    {
                        "SubstepNumber": 8.1,
                        "SubstepString": "Conduct an investigation."
                    },
                    {
                        "SubstepNumber": 8.2,
                        "SubstepString": "Discover the smarty-4.0.1 PHP library."
                    },
                    {
                        "SubstepNumber": 8.3,
                        "SubstepString": "Discover the templates_c folder."
                    }
                ]
            },
            {
                "StepNumber": 9,
                "StepString": "Accessed the template files on the server and obtained their content",
                "Substeps": [
                    {
                        "SubstepNumber": 9.1,
                        "SubstepString": "Access the template files on the server."
                    },
                    {
                        "SubstepNumber": 9.2,
                        "SubstepString": "Obtain the content of the template files."
                    }
                ]
            },
            {
                "StepNumber": 10,
                "StepString": "Leaked the source code of PHP with a payload",
                "Substeps": [
                    {
                        "SubstepNumber": 10.1,
                        "SubstepString": "Use a payload to leak the source code of PHP."
                    }
                ]
            },
            {
                "StepNumber": 11,
                "StepString": "Discovered the flag within the source code",
                "Substeps": [
                    {
                        "SubstepNumber": 11.1,
                        "SubstepString": "Discover the flag within the source code."
                    }
                ]
            }
        ]
    }
}