{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Analyze the provided source code and discover that the secret key is 1234.",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Examine the provided source code meticulously."
                    },
                    {
                        "SubstepNumber": 1.2,
                        "SubstepString": "Identify and note down the discovered secret key as 1234."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Log in with given credentials (user:\"user\", pass:\"user\") and capture the JWT token from the payload.",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Enter the given credentials (username: \"user\", password: \"user\") in the login page."
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Capture the resulting JWT token from the payload after successful login."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Decode the JWT token using jwt.io to find the userId as 1.",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Navigate to jwt.io."
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Input the captured JWT token to decode it."
                    },
                    {
                        "SubstepNumber": 3.3,
                        "SubstepString": "Identify and note the userId as 1 from the decoded information."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Encode a new JWT token with the role Admin.",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Construct a payload with the role set as Admin."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Use a suitable JWT library or tool to encode the new payload into a JWT token."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Use Postman to send requests with the new JWT token to update the user role and read the flag.",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Open Postman and configure it to send requests to the target server."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Insert the newly created JWT token in the Authorization header of the requests."
                    },
                    {
                        "SubstepNumber": 5.3,
                        "SubstepString": "Send requests to update the user role and to read the flag, capturing the responses."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Create a new user on the site as the default user role cannot be patched.",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Navigate to the user registration page on the target site."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Fill out the required information to create a new user account."
                    },
                    {
                        "SubstepNumber": 6.3,
                        "SubstepString": "Confirm that the new user is created with a default user role."
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "Obtain the users list, find the new user's id (e.g., 6), and patch the user's role to Admin.",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Send a request to the appropriate endpoint to retrieve the list of users."
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Identify the ID of the newly created user from the users list."
                    },
                    {
                        "SubstepNumber": 7.3,
                        "SubstepString": "Send a patch request to update the identified userâ€™s role to Admin."
                    }
                ]
            },
            {
                "StepNumber": 8,
                "StepString": "Log in as an Admin and read the flag.",
                "Substeps": [
                    {
                        "SubstepNumber": 8.1,
                        "SubstepString": "Log out of the current session, if logged in."
                    },
                    {
                        "SubstepNumber": 8.2,
                        "SubstepString": "Log in again using the credentials of the newly created Admin user."
                    },
                    {
                        "SubstepNumber": 8.3,
                        "SubstepString": "Navigate to the designated area accessible to Admin users to read the flag."
                    }
                ]
            }
        ]
    }
}
