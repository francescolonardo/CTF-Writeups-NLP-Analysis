{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Visit the server script at http://chall.csivit.com:30279/.",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Open a web browser and enter the provided URL to access the server script."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Exploit Tornado template injection with http://chall.csivit.com:30279/?icecream={{globals()}} to find the application variable.",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Construct a URL with the Tornado template injection payload targeting the ‘globals()’ method."
                    },
                    {
                        "SubstepNumber": 2.2,
                        "SubstepString": "Visit the constructed URL to execute the payload and observe the response for any disclosed application variables."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Use the payload http://chall.csivit.com:30279/?icecream={{application.settings['cookie_secret']}} to obtain the cookie_secret value MangoDB.",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Craft a new URL incorporating a payload aimed at extracting the ‘cookie_secret’ value from the application settings."
                    },
                    {
                        "SubstepNumber": 3.2,
                        "SubstepString": "Navigate to the newly formed URL and review the response to capture the disclosed ‘cookie_secret’ value."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Set the secure cookie admin to true and generate a signed cookie in the browser.",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Locate the browser’s cookie settings and modify the ‘admin’ cookie’s value to ‘true’."
                    },
                    {
                        "SubstepNumber": 4.2,
                        "SubstepString": "Initiate the process to generate a new signed cookie reflecting the modified ‘admin’ cookie value."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Replace the signed cookie generated upon running the server script with the one obtained after setting the secure cookie value to true.",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Identify and copy the signed cookie generated after modifying the ‘admin’ cookie value."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Locate the original signed cookie created by running the server script and overwrite it with the copied signed cookie."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Reload the server script to see the flag value on the website.",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Refresh the webpage running the server script."
                    },
                    {
                        "SubstepNumber": 6.2,
                        "SubstepString": "Inspect the reloaded page content to locate and read the displayed flag value."
                    }
                ]
            }
        ]
    }
}
