<h1>b01lers CTF 2020 â€“ Space Noodles</h1>

<ul>
<li><strong>Category:</strong> web</li>
<li><strong>Points:</strong> 200</li>
</ul>

<h2>Challenge</h2>

<blockquote>
  <p>What do you get when you cross spaghetti with zero g's?</p>
  
  <p>http://web.ctf.b01lers.com:1003/</p>
</blockquote>

<h2>Solution</h2>

<p>This was a guessing challenge and I didn't like it very much.</p>

<p>Trying to connect to the homepage will give you an error of HTTP method not allowed.</p>

<p>```
GET / HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1</p>

<p>HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 121
Server: Werkzeug/1.0.0 Python/3.7.6
Date: Sat, 14 Mar 2020 10:24:44 GMT</p>

<p><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>Not Allowed</title></p>

<h1>Not Allowed</h1>

<p>Cant GET /</p>

<p>```</p>

<p>If you try a wrong HTTP verb, the server will return all the allowed methods.</p>

<p>```
POTATOE / HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1</p>

<p>HTTP/1.0 405 METHOD NOT ALLOWED
Content-Type: text/html; charset=utf-8
Allow: GET, HEAD, PUT, PATCH, CONNECT, OPTIONS, TRACE, DELETE, POST
Content-Length: 178
Server: Werkzeug/1.0.0 Python/3.7.6
Date: Sat, 14 Mar 2020 10:26:17 GMT</p>

<p><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>405 Method Not Allowed</title></p>

<h1>Method Not Allowed</h1>

<p>The method is not allowed for the requested URL.</p>

<p>```</p>

<p>Trying each method, you can discover that some of them, i.e. <code>POST</code> and <code>PUT</code>, will return a different result.</p>

<p>```
POST / HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1</p>

<p>HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 570
Server: Werkzeug/1.0.0 Python/3.7.6
Date: Sat, 14 Mar 2020 10:31:13 GMT</p>

<p><html>
  </body>
      <body>
        <text><p></text>text ? pleas test teh follwing five roots<p>,</p>
  <list>
    <one></p>

<p>circle</one>
    <enter>
    <enter>
    <sendkey(enter)&gt;</p>

<p>two
  I'm am making an a pea eye and its grate</p>

<pre><code>     PHP is the best
  &lt;php?&gt; printf(hello world) &lt;/php&gt;
</code></pre>

<p>square<?/p>two</p>

<p>:pleasequithelpwww.google.
com/seaerch</p>

<pre><code>how to exit
</code></pre>

<p>vim/quit
  :wqwhy isnt it working:wq:wq:wq:qw?</p>

<pre><code>  &lt;/body&gt;
                                                                                                                            &lt;/html&gt;
</code></pre>

<p>```</p>

<p>At this point you have to guess that the following endpoints are present:
* <code>/circle/one/</code>;
* <code>/two/</code>;
* <code>/square/</code>;
* <code>/com/seaerch/</code>;
* <code>/vim/quit/</code>.</p>

<p>For each endpoint, you have to try all HTTP verbs in order to discover the correct one to use.</p>

<p>The <code>/circle/one/</code> endpoint will return a <a href="http_web.ctf.b01lers.com_1003_circle_one.pdf">PDF file</a>.</p>

<p>```
OPTIONS /circle/one/ HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 0</p>

<p>HTTP/1.0 200 OK
Content-Length: 3322704
Content-Type: application/pdf
Last-Modified: Tue, 10 Mar 2020 20:13:28 GMT
Cache-Control: public, max-age=43200
Expires: Sun, 15 Mar 2020 02:03:47 GMT
ETag: "1583871208.0-3322704-1012733123"
Server: Werkzeug/1.0.0 Python/3.7.7
Date: Sat, 14 Mar 2020 14:03:47 GMT</p>

<p>%PDF-1.3
```</p>

<p>The PDF says: <code>Put Your Best Food Forward With HEINZ KETCHUP</code>. At this point I had no idea of what to do next.</p>

<p>Two different answers can be obtained on <code>/two/</code> endpoint with <code>PUT</code> and <code>CONNECT</code> HTTP verbs.</p>

<p>```
PUT /two/ HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 0</p>

<p>HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 15
Server: Werkzeug/1.0.0 Python/3.7.6
Date: Sat, 14 Mar 2020 10:55:40 GMT</p>

<p>Put the dots???
```</p>

<p>The <code>CONNECT /two/</code> request will return a PNG image.</p>

<p>```
CONNECT /two/ HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 0</p>

<p>HTTP/1.0 200 OK
Content-Length: 67798
Content-Type: image/png
Last-Modified: Tue, 10 Mar 2020 20:13:28 GMT
Cache-Control: public, max-age=43200
Expires: Sat, 14 Mar 2020 22:56:58 GMT
ETag: "1583871208.0-67798-3337817112"
Server: Werkzeug/1.0.0 Python/3.7.6
Date: Sat, 14 Mar 2020 10:56:58 GMT</p>

<p>PNG
```</p>

<p><img src="two.png" alt="two.png" /></p>

<p>The image contains the string <code>up_on_noodles_</code>, that is a part of the flag.</p>

<p>The <code>/square/</code> endpoint will return a PNG image with a crossword puzzle.</p>

<p>```
DELETE /square/ HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 0</p>

<p>HTTP/1.0 200 OK
Content-Length: 211123
Content-Type: image/png
Last-Modified: Tue, 10 Mar 2020 20:13:28 GMT
Cache-Control: public, max-age=43200
Expires: Sat, 14 Mar 2020 23:12:50 GMT
ETag: "1583871208.0-211123-3343453223"
Server: Werkzeug/1.0.0 Python/3.7.6
Date: Sat, 14 Mar 2020 11:12:50 GMT</p>

<p>PNG
```</p>

<p><img src="square.png" alt="square.png" /></p>

<p>The solution is the following.</p>

<p><code>
    E
    S
    I
    R
    P
  E R
  C E
  A T
E P N
TASTES
 L A U
 D U L
 E   A
 R   C
 A   O
 A
 N
</code></p>

<p>The <code>/com/seaerch/</code> endpoint will return the following webpage.</p>

<p>```
GET /com/seaerch/ HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 0</p>

<p>HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 94
Server: Werkzeug/1.0.0 Python/3.7.7
Date: Sat, 14 Mar 2020 15:02:41 GMT</p>

<p><htlm></p>

<p>,,,,,,,,,<search> &lt;-- comment for search --!>:</p>

<p>ERROR </> search=null</end></p>

<p></html>
```</p>

<p>At this point, you have to guess that an <code>application/x-www-form-urlencoded</code> parameter must be used to perform the search operation</p>

<p>```
GET /com/seaerch/ HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 10
Content-Type: application/x-www-form-urlencoded</p>

<p>search=foo</p>

<p>HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 142
Server: Werkzeug/1.0.0 Python/3.7.7
Date: Sat, 14 Mar 2020 20:02:46 GMT</p>

<p><htlm></p>

<p>,,,,,,,,,<search> &lt;-- comment for search --!>:</p>

<p><query> foo is not a good search, please use this one instead: 'flag' <try></p>

<p></html>
```</p>

<p>Using the <code>flag</code> value will give you another part of the flag.</p>

<p>```
GET /com/seaerch/ HTTP/1.1
Host: web.ctf.b01lers.com:1003
Comment: foo
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Content-Length: 11
Content-Type: application/x-www-form-urlencoded</p>

<p>search=flag</p>

<p>HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 126
Server: Werkzeug/1.0.0 Python/3.7.7
Date: Sat, 14 Mar 2020 20:03:13 GMT</p>

<p><htlm></p>

<p>,,,,,,,,,<search> &lt;-- comment for search --!>:</p>

<p><query> good search</query>
  results: <p><em>good</em>in_s</p>:w</p>

<p></html>
```</p>

<p>The <code>/vim/quit/</code> endpoint will tell you to use a query parameter.</p>

<p>```
TRACE /vim/quit/ HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Cookie: session=0
Upgrade-Insecure-Requests: 1</p>

<p>HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 109
Server: Werkzeug/1.0.0 Python/3.7.7
Date: Sat, 14 Mar 2020 19:27:54 GMT</p>

<p><hteeemel<body>&gt;</p>

<pre><code>                &lt;wrong&gt;uh oh 
              ?exit=null
        &lt;/wrong&gt;
</code></pre>

<p></>
```</p>

<p>Passing a random value will let you to discover that a <em>vim</em> command must be used.</p>

<p>```
TRACE /vim/quit/?exit=foo HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1</p>

<p>HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 104
Server: Werkzeug/1.0.0 Python/3.7.7
Date: Sat, 14 Mar 2020 19:28:49 GMT</p>

<p><hteeemel<body>&gt;</p>

<pre><code>   &lt;erroror&gt;&lt;p&gt;E492: Not an editor command: foo&lt;/p&gt;
</code></pre>

<p></errorror>
 </flag></p>

<p></>
```</p>

<p>Considering that the name of the parameter is <code>exit</code>, you have to discover that <code>:wq</code> is the correct value to use.</p>

<p>```
TRACE /vim/quit/?exit=:wq HTTP/1.1
Host: web.ctf.b01lers.com:1003
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8
Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1</p>

<p>HTTP/1.0 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 102
Server: Werkzeug/1.0.0 Python/3.7.7
Date: Sat, 14 Mar 2020 19:30:59 GMT</p>

<p><hteeemel<body>&gt;</p>

<pre><code>  &lt;flag&gt; well done wait &lt;/flag&gt;
</code></pre>

<p><text> this one/> <flag>pace_too}</flag></p>

<p></>
```</p>

<p>Putting everything together will give you the following.</p>

<p><code>
1 2              3      4          5   
  up_on_noodles_ tastes _good_in_s pace_too}
</code></p>

<p>At this point you can easily guess the first part of the flag (referred to the PDF).</p>

<p><code>
pctf{ketchup_on_noodles_tastes_good_in_space_too}
</code></p>
