1. Notice that `mootools` JavaScript library is used. This is vulnerable to client-side prototype pollution.

Refer to the [PoC](https://github.com/BlackFan/client-side-prototype-pollution/blob/master/pp/mootools-more.md).

2. Notice that if the request token is wrong, then the `request.accessGranted` attribute is never set and is thus undefined.

By exploiting the prototype pollution vulnerability, we are able to pollute the `accessGranted` attribute and prevent the access denied error.

3. Notice that the note is "found" as long as `note.startsWith(request.search)`. This, combined with the fact that a navigation occurs (redirection after 5 seconds of viewing the note) on a successful search allows us to perform an XS leak.

This attack is performed by inspecting `history.length` and is described [here](https://xsleaks.dev/docs/attacks/navigations/)

As long as a navigation has occured, i.e. `history.length === 3`, our substring exists in the flag.

Extract the full flag character by character: `SEE{w4k3_up_5h33pl3_1t's_obv10us}`.
