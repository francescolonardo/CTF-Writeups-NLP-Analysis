{
    "AttackModel": {
        "Steps": [
            {
                "StepNumber": 1,
                "StepString": "Inspect the source code and discover that all other endpoints are protected by authenticationMiddleware",
                "Substeps": [
                    {
                        "SubstepNumber": 1.1,
                        "SubstepString": "Inspect the source code."
                    },
                    {
                        "SubstepNumber": 1.2,
                        "SubstepString": "Discover that all other endpoints are protected by authenticationMiddleware."
                    }
                ]
            },
            {
                "StepNumber": 2,
                "StepString": "Understand that the mysqljs/mysql package is used without the option stringifyObjects: true",
                "Substeps": [
                    {
                        "SubstepNumber": 2.1,
                        "SubstepString": "Understand that the mysqljs/mysql package is used without the option stringifyObjects: true."
                    }
                ]
            },
            {
                "StepNumber": 3,
                "StepString": "Recognize that the express.json() allows Object and Array types to be given as req.body.email and req.body.password",
                "Substeps": [
                    {
                        "SubstepNumber": 3.1,
                        "SubstepString": "Recognize that the express.json() allows Object and Array types to be given as req.body.email and req.body.password."
                    }
                ]
            },
            {
                "StepNumber": 4,
                "StepString": "Use this behaviour when constructing SQL queries to bypass the login",
                "Substeps": [
                    {
                        "SubstepNumber": 4.1,
                        "SubstepString": "Use this behaviour when constructing SQL queries to bypass the login."
                    }
                ]
            },
            {
                "StepNumber": 5,
                "StepString": "Authenticate successfully and gain access to the application",
                "Substeps": [
                    {
                        "SubstepNumber": 5.1,
                        "SubstepString": "Authenticate successfully."
                    },
                    {
                        "SubstepNumber": 5.2,
                        "SubstepString": "Gain access to the application."
                    }
                ]
            },
            {
                "StepNumber": 6,
                "StepString": "Discover that the Express application is put behind a reverse proxy (Apache Traffic Server)",
                "Substeps": [
                    {
                        "SubstepNumber": 6.1,
                        "SubstepString": "Discover that the Express application is put behind a reverse proxy (Apache Traffic Server)."
                    }
                ]
            },
            {
                "StepNumber": 7,
                "StepString": "Realize that the /do-report endpoint is mapped to /forbidden, preventing access unless not going through the proxy",
                "Substeps": [
                    {
                        "SubstepNumber": 7.1,
                        "SubstepString": "Realize that the /do-report endpoint is mapped to /forbidden."
                    },
                    {
                        "SubstepNumber": 7.2,
                        "SubstepString": "Recognize that access is prevented unless not going through the proxy."
                    }
                ]
            },
            {
                "StepNumber": 8,
                "StepString": "Research about the versions of Node.js and ATS used",
                "Substeps": [
                    {
                        "SubstepNumber": 8.1,
                        "SubstepString": "Research about the versions of Node.js and ATS used."
                    }
                ]
            },
            {
                "StepNumber": 9,
                "StepString": "Find a HTTP request smuggling issue with incorrect parsing of chunk extensions",
                "Substeps": [
                    {
                        "SubstepNumber": 9.1,
                        "SubstepString": "Find a HTTP request smuggling issue with incorrect parsing of chunk extensions."
                    }
                ]
            },
            {
                "StepNumber": 10,
                "StepString": "Modify the available PoC to suit the given context",
                "Substeps": [
                    {
                        "SubstepNumber": 10.1,
                        "SubstepString": "Modify the available PoC to suit the given context."
                    }
                ]
            },
            {
                "StepNumber": 11,
                "StepString": "Smuggle a request to the backend application, bypassing the access control implemented on ATS",
                "Substeps": [
                    {
                        "SubstepNumber": 11.1,
                        "SubstepString": "Smuggle a request to the backend application."
                    },
                    {
                        "SubstepNumber": 11.2,
                        "SubstepString": "Bypass the access control implemented on ATS."
                    }
                ]
            },
            {
                "StepNumber": 12,
                "StepString": "Understand that the verify.pug template has a unescaped username allowing HTML markup injection",
                "Substeps": [
                    {
                        "SubstepNumber": 12.1,
                        "SubstepString": "Understand that the verify.pug template has an unescaped username."
                    },
                    {
                        "SubstepNumber": 12.2,
                        "SubstepString": "Recognize that HTML markup injection is allowed."
                    }
                ]
            },
            {
                "StepNumber": 13,
                "StepString": "Learn about the Scroll-To-Text-Fragment (STTF) which is a Chromium feature allowing to scroll to a specific portion of the page using a text snippet in the URL",
                "Substeps": [
                    {
                        "SubstepNumber": 13.1,
                        "SubstepString": "Learn about the Scroll-To-Text-Fragment (STTF)."
                    },
                    {
                        "SubstepNumber": 13.2,
                        "SubstepString": "Recognize that STTF is a Chromium feature."
                    },
                    {
                        "SubstepNumber": 13.3,
                        "SubstepString": "Understand that STTF allows scrolling to a specific portion of the page using a text snippet in the URL."
                    }
                ]
            },
            {
                "StepNumber": 14,
                "StepString": "Use the lazy-loaded image to detect if a scroll occurred when a text fragment is parsed in the URL",
                "Substeps": [
                    {
                        "SubstepNumber": 14.1,
                        "SubstepString": "Use the lazy-loaded image."
                    },
                    {
                        "SubstepNumber": 14.2,
                        "SubstepString": "Detect if a scroll occurred when a text fragment is parsed in the URL."
                    }
                ]
            },
            {
                "StepNumber": 15,
                "StepString": "Automate the submission of different text fragments and for each text fragment, detect if a callback is received",
                "Substeps": [
                    {
                        "SubstepNumber": 15.1,
                        "SubstepString": "Automate the submission of different text fragments."
                    },
                    {
                        "SubstepNumber": 15.2,
                        "SubstepString": "For each text fragment, detect if a callback is received."
                    }
                ]
            },
            {
                "StepNumber": 16,
                "StepString": "Use this method to bruteforce the admin token one character at a time",
                "Substeps": [
                    {
                        "SubstepNumber": 16.1,
                        "SubstepString": "Use this method to bruteforce the admin token one character at a time."
                    }
                ]
            },
            {
                "StepNumber": 17,
                "StepString": "Automate the full exploit chain in solve.py",
                "Substeps": [
                    {
                        "SubstepNumber": 17.1,
                        "SubstepString": "Automate the full exploit chain in solve.py."
                    }
                ]
            },
            {
                "StepNumber": 18,
                "StepString": "Adjust necessary parameters in the python script",
                "Substeps": [
                    {
                        "SubstepNumber": 18.1,
                        "SubstepString": "Adjust necessary parameters in the python script."
                    }
                ]
            }
        ]
    }
}