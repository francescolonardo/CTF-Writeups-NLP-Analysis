Title: Type Juggling in GetFacts Endpoint
Primary topic: Web Exploitation
Secondary topic: PHP
Tools used: Burp Suite
Keywords: type juggling, switch statements, loose comparison

#context
Opening the challenge website, we get the following page. It presents three buttons on the right to see other facts.

#discovery
Clicking on secret facts, it says, can only be accessed by admin. Looking at the Burp Suite proxy, under the hood, it is sending a post request to the getfacts endpoint with the fact type parameter.

#code
Looking into the source code, the getfacts endpoint is controlled by the getfacts function. The getfacts function basically has two main things. First, there's an if statement that checks if the request fact type is secret and the request is not coming from localhost, then return the message that we saw earlier in the response. Second, there's a switch statement which checks the type and returns the facts.

#exploitation
The switch statements in PHP use loose comparison (==). By providing the true keyword in the type parameter, the first switch case becomes true and presents the secrets and the flag.

#countermeasures
This challenge demonstrates the importance of proper input validation and sanitization to prevent vulnerabilities such as type juggling. It also highlights the need for secure coding practices and the use of strict comparison (===) in switch statements.