{
    "AttackModel": {
        "NameOfTheChallenge": "Selfhost all the things!",
        "AttackerCapabilities": [
            "HTTP parameter manipulation",
            "Understanding of OAuth2 flow",
            "Web application reconnaissance"
        ],
        "Target": {
            "Type": "Web Application",
            "Vulnerabilities": [
                "Improper handling of OAuth2 Identity Provider selection",
                "Lack of input validation on OAuth2 Identity Provider selection"
            ],
            "SecurityMeasures": [
                "OAuth2 authentication flow"
            ]
        },
        "Steps": [
            {
                "StepNumber": 1,
                "Description": "The attacker accesses the main webpage and clicks on the 'Enter' link.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker hypothesizes that the link will lead to a login page.",
                    "Action": "The attacker clicks on the 'Enter' link.",
                    "Result": "The attacker is redirected to the login page.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 2,
                "Description": "The attacker selects 'Discord' as the OAuth2 Identity Provider.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker hypothesizes that selecting 'Discord' will trigger an HTTP request to the Discord API.",
                    "Action": "The attacker selects 'Discord' as the OAuth2 Identity Provider.",
                    "Result": "The attacker generates an HTTP request to the Discord API.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 3,
                "Description": "The attacker manipulates the 'with' parameter in the URL, trying various values.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker hypothesizes that manipulating the 'with' parameter may trigger different behavior or vulnerabilities.",
                    "Action": "The attacker manipulates the 'with' parameter value with different values ('foo', 'flag', etc.).",
                    "Result": "The attacker discovers that using the value 'flag' triggers an interesting redirection.",
                    "Success": "Success",
                    "FailingReason": null
                }
            },
            {
                "StepNumber": 4,
                "Description": "The attacker follows the redirection to a webpage with the flag.",
                "ToolsUsed": null,
                "StepDetails": {
                    "Hypothesis": "The attacker hypothesizes that following the redirection will lead to a webpage with the flag.",
                    "Action": "The attacker follows the redirection.",
                    "Result": "The attacker successfully obtains the flag from the webpage.",
                    "Success": "Success",
                    "FailingReason": null
                }
            }
        ]
    }
}